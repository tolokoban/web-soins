{"version":3,"sources":["structure/parser.yaml","tfw/view/input-date.yaml","App.yaml","report/report.fods","presentational/stat.yaml","state/user.ts","state/organizations.ts","state/carecenters.ts","structure/index.ts","state/structures.ts","state/stats-config.ts","state/stats.ts","util/hash.ts","state/index.ts","service/organization.ts","service/carecenter.ts","structure/parser.ts","service/structure.ts","tfw/permissive-json/tokenizer.ts","tfw/permissive-json/index.ts","tfw/fileapi.ts","tfw/util.ts","tfw/view/input-file/index.tsx","tfw/view/touchable.tsx","tfw/view/expand/expand.tsx","tfw/debouncer.ts","tfw/view/input-date.tsx","presentational/form-field.tsx","intl.ts","presentational/consultation-query/consultation-query.tsx","service/query.ts","report/report-view.tsx","report/report.tsx","presentational/carecenter-header.tsx","presentational/stats-config.tsx","container/stats-config.ts","dialog/stats-config.tsx","container/carecenter-header.tsx","presentational/wait/wait.tsx","presentational/pie.tsx","service/stat.ts","presentational/stat.tsx","tfw/layout/sidemenu.tsx","container/sidemenu.tsx","App.tsx","main.tsx"],"names":["module","exports","fr","err-1","err-2","err-3","en","invalid","month-0","month-1","month-2","month-3","month-4","month-5","month-6","month-7","month-8","month-9","month-10","month-11","cancel","close","code","consultations","consultations-count","create-stat","create-stat-consultation","create-stat-patient","date-min","date-max","execute-query","filter","generating-report","hint-report-templates","loading","loading-report","logout","patients","patients-count","query-in-progress","report","stat-type","struct","welcome","__webpack_require__","p","export","no-data","ATTRIBUTES","Set","state_user","INITIAL_STATE","email","nickname","language","roles","reducer","state","action","type","startsWith","attName","substr","length","has","Error","concat","attValue","data","Object","assign","defineProperty","setLanguage","setNickname","state_organizations","organizations","slice","organization","newState","push","add","map","item","id","update","setOrganizations","addOrganization","updateOrganization","state_carecenters","carecenters","carecenter","setCarecenters","addCarecenter","updateCarecenter","src_structure","createPatientsFieldsFromStructure","structure","patientsFields","patientFields","forEach","patientField","createPatientsFieldsCaptionsFromStructure","patientsFieldsCaptions","Intl","toText","caption","getFieldCaption","key","charAt","formFields","state_structures","structures","setStructures","addStructure","updateStructure","stats_config","statsType","dateMin","today","Date","getDate","firstDayOfCurrentMonth","getFullYear","getMonth","getTime","lastMonth","dateMax","now","birthday","size","nationality","organizationId","structureId","patientsCount","consultationsCount","name","objectSpread","setType","date","setDateMin","setDateMax","fields","setPatientsFields","fieldName","castString","fieldVisibility","castBoolean","setPatientField","state_stats","stats","stat","addStat","hash","statsConfig","obj","user","User","Organizations","Carecenters","Structures","StatsConfig","Stats","store","createStore","arguments","undefined","console","log","carecenterId","find","c","s","Structure","initStatsConfig","h","Hash","removeStat","src_state","dispatch","service_organization","list","_list","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","WebService","exec","abrupt","sent","stop","apply","this","service_carecenter","_x","_","make","require","RX_LINE","structure_parser","parse","types","levels","split","line","lineNumber","trim","level","computeLevel","pop","children","m","toUpperCase","tags","v","parseLine","ex","message","flattenFormsFields","forms","recursiveFlattenFormsFields","path","keys","child","sort","b","captionA","captionB","service_structure","parsePatient","patient","parseFormFields","exams","vaccins","sources","def","Parser","error","stringifiedPatientDef","raw","toIntl","result","fringe","shift","_arr","_i","value","OBJ_OPEN","OBJ_CLOSE","ARR_OPEN","ARR_CLOSE","STRING","NUMBER","SPECIAL","COLON","TYPE_NAMES","tokenizer","tokenize","source","Context","getTypeName","RX_DECIMAL","RX_HEXA","RX_OCTAL","RX_BINARY","_this","classCallCheck","eaters","index","end","tokens","eatBlanks","indexOf","peek","eatSymbol","tkn","addToken","eatComment","endOfSingleComment","endOfComment","fail","eatString","start","quote","escape","str","eos","eatIdentifier","test","parseFloat","parseInt","currentSourceIndex","eaterIndex","eater","msg","permissive_json","isValid","text","Tokenizer","Math","max","parseObject","parseArray","back","arr","indexForMissingKey","val","fileapi","saveAs","blob","fileName","url","window","URL","createObjectURL","anchorElem","document","createElement","style","display","href","download","body","appendChild","click","removeChild","setTimeout","revokeObjectURL","util","padNumber","fillWith","clamp","min","loadTextFromFile","file","Promise","resolve","reject","reader","FileReader","onload","content","target","onerror","err","readAsText","loadTextFromURL","fetch","then","response","ok","status","statusText","catch","loadJsonFromURL","json","InputFile","props","possibleConstructorReturn","getPrototypeOf","call","refInput","React","createRef","handleClick","bind","assertThisInitialized","handleFileChange","evt","handler","onClick","files","input","current","classes","wide","react_default","className","join","view_button","label","icon","wait","flat","small","warning","enabled","ref","accept","multiple","onChange","Component","Touchable","touchable","TouchableBehavior","onTap","color","element","castArray","classNames","react","tabIndex","title","Expand","handleValueChange","onValueChange","touchable_Touchable","debouncer","delay","timer","_len","args","Array","_key","clearTimeout","Input","inputDay","inputMonth","inputYear","handleChange","Debouncer","day","isNaN","month","year","setState","castInteger","globalId","header","htmlFor","maxLength","defaultValue","monthId","FormField","setValue","values","Storage","local","set","info","renderField","field","renderTypedField","expand_Expand","get","_this2","isArray","view_checkbox","input_date_Input","JSON","stringify","combo","t","ContainerQuery","handleQueryChange","query","valid","PermissiveJSON","handleExecuteClick","_this$state","onQueryClick","handleDateMinChange","handleDateMaxChange","oneYearBack","_this$state2","flex","rows","valueOf","service_query","getConsultationIds","getConsultationsFields","ids","_callee2","consultationIds","output","_context2","ReportView","handleFilesChange","onFilesChange","handleQueryClick","_ref","minDate","maxDate","csvContent","Dialog","queryConsultations","Blob","SaveAs","convertToDate","_x2","_x3","State","getState","QueryService","f","patientKey","tail","toConsumableArray","input_file_InputFile","dangerouslySetInnerHTML","__html","consultation_query_ContainerQuery","form_field_FormField","secondsSinceEpoch","yy","mm","dd","src_report_report","generate","extraData","alert","generateFromTemplate","generateFromUserProvidedFile","_callee3","_context3","Util","LibreOfficeCalcTemplate","doGenerate","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","Symbol","iterator","done","t0","return","finish","dialog","hide","show","report_view_ReportView","footer","_callee4","domParser","doc","placeholders","serializer","xml","_context4","DOMParser","parseFromString","findPlaceholders","documentElement","elem","textContent","_ref2","WS","Number","parent","parentElement","setAttribute","XMLSerializer","serializeToString","FileAPI","nodeType","Node","ELEMENT_NODE","nodeName","endsWith","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","childNodes","CarecenterHeader","handleStatClick","onStatClick","handleStructClick","onStructClick","handleReportClick","Report","handleTypeChange","onTypeChange","onDateMinChange","onDateMaxChange","connect","Actions","dialog_stats_config","closeOnEscape","es","container_stats_config","StatsConfigDialog","Wait","animate","DEFAULT_COLORS","Pie","canvas","paint","colors","width","radius","floor","turn","PI","angleStep","total","reduce","acc","ctx","getContext","angle","angleTarget","lineTo","ang","sin","cos","save","clearRect","translate","fillStyle","globalAlpha","ellipse","fill","strokeStyle","lineWidth","i","beginPath","moveTo","closePath","stroke","restore","height","service_stat","extract","_extract","extraction","begin","convertTime","consultation","convertIntoOccurences","milliseconds","occurences","sum","occ","fieldValues","sortDescBySecondElement","A","Stat","selectedField","handleClose","onClose","dataFromService","refresh","StatService","_getFieldsKeysAndValu","getFieldsKeysAndValues","fieldKey","idx","fieldCaption","slicedToArray","count","_getFieldsKeysAndValu2","pie_Pie","getValuesForPie","_ref3","_ref4","colorIndex","justifyContent","alignItems","dir","background","formatDate","array","B","d","sectors","Sidemenu","refMenu","handleShowChange","menu","Gesture","on","swipeleft","onShowChange","innerWidth","head","stat_Stat","carecentersOfOrganization","wait_Wait","container_carecenter_header","renderCareCenterHeader","location","reload","onLanguageClick","onLogoutClick","App","src_container_sidemenu","__webpack_exports__","_start","root","getElementById","ReactDOM","render","App_App","lang","ServiceOrganization","ServiceStructure","ServiceCarecenter"],"mappings":"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","file":"static/js/2.285cf0c1.chunk.js","sourcesContent":["module.exports = {\"fr\":{\"err-1\":\"Une ligne non vide et non commentée doit toujours commencer par au moins une astérisque pour indiquer le niveau hiérarchique.\",\"err-2\":\"<html>Vous avez sauté au moins un niveau hiérarchique:<br/><code>$1</code> !<br/><br/>Vous étiez au niveau <b>$2</b> et vous définissez maintenant le niveau <b>$3</b>.\",\"err-3\":\"<html>Vous avez déjà déclaré cet identifiant : <b>$1</b> !\"}}","module.exports = {\"en\":{\"invalid\":\"Invalid date!\",\"month-0\":\"Jan\",\"month-1\":\"Feb\",\"month-2\":\"Mar\",\"month-3\":\"Apr\",\"month-4\":\"May\",\"month-5\":\"Jun\",\"month-6\":\"Jul\",\"month-7\":\"Aug\",\"month-8\":\"Sep\",\"month-9\":\"Oct\",\"month-10\":\"Nov\",\"month-11\":\"Dec\"},\"fr\":{\"invalid\":\"Date invalide !\",\"month-0\":\"Jan\",\"month-1\":\"Fév\",\"month-2\":\"Mar\",\"month-3\":\"Avr\",\"month-4\":\"Mai\",\"month-5\":\"Jun\",\"month-6\":\"Jul\",\"month-7\":\"Aou\",\"month-8\":\"Sep\",\"month-9\":\"Oct\",\"month-10\":\"Nov\",\"month-11\":\"Déc\"}}","module.exports = {\"en\":{\"cancel\":\"Cancel\",\"close\":\"Close\",\"code\":\"Code:\",\"consultations\":\"Consultations\",\"consultations-count\":\"Consultations:\",\"create-stat\":\"Create Statistics\",\"create-stat-consultation\":\"Consult. Statistics\",\"create-stat-patient\":\"Patients Statistics\",\"date-min\":\"Start Date\",\"date-max\":\"End Date\",\"execute-query\":\"Execute Query\",\"filter\":\"Filter\",\"generating-report\":\"Generating report...\",\"hint-report-templates\":\"Report templates are spreadsheet saved as <b>Flat XML Spreadsheet</b> with placeholders like the following ones:\",\"loading\":\"Loading in progress...\",\"loading-report\":\"Loading report template...\",\"logout\":\"Logout\",\"patients\":\"Patients\",\"patients-count\":\"Patients:\",\"query-in-progress\":\"Query in progress...\",\"report\":\"To add an annual report, clic on the left pane's button bearing the following icon:\",\"stat-type\":\"Statistic Type\",\"struct\":\"Structure:\",\"welcome\":\"To add new statistics, clic on the left pane's button bearing the following icon:\"},\"fr\":{\"cancel\":\"Annuler\",\"close\":\"Fermer\",\"code\":\"Code :\",\"consultations\":\"Consultations\",\"consultations-count\":\"Consultations :\",\"create-stat\":\"Créer des statistiques\",\"create-stat-consultation\":\"Stats consultations\",\"create-stat-patient\":\"Stats patients\",\"date-min\":\"Date de début\",\"date-max\":\"Date de fin\",\"execute-query\":\"Executer la requête\",\"filter\":\"Filtre\",\"generating-report\":\"Rapport en cours de réalisation...\",\"hint-report-templates\":\"Les modèles de rapports sont des fichier <b>Open Office Calc Flat XML Spreadsheet</b> avec des requêtes intégrées comme celles-ci:\",\"loading\":\"Chargement en cours...\",\"loading-report\":\"Chargement du modèle de rapport...\",\"logout\":\"Déconnexion\",\"patients\":\"Patients\",\"patients-count\":\"Patients :\",\"query-in-progress\":\"Requête en cours...\",\"report\":\"Pour éditer un rapport annuel, cliquez sur le bouton avec l'icône suivante dans le panneau de gauche :\",\"stat-type\":\"Type de statistique\",\"struct\":\"Structure :\",\"welcome\":\"Pour ajouter des statistiques, cliquez sur le bouton avec l'icône suivante dans le panneau de gauche : \"}}","module.exports = __webpack_public_path__ + \"static/media/report.261bdad3.fods\";","module.exports = {\"en\":{\"close\":\"Close\",\"export\":\"Export to Spreadsheet\",\"no-data\":\"There is no data for this period!\"},\"fr\":{\"close\":\"Fermer\",\"export\":\"Exporter vers un tableur\",\"no-data\":\"Il n'y a aucune donnée sur cette période !\"}}","import { IAction, IUser } from \"../types\"\n\nconst PREFIX = \"user:\";\nconst ATTRIBUTES = new Set(['nickname', 'language']);\n\nexport default {\n    INITIAL_STATE: { email: \"\", nickname: \"\", language: \"\", roles: [] },\n\n    reducer(state: IUser, action: IAction): IUser {\n        const { type } = action;\n        if (!type.startsWith(PREFIX)) return state;\n\n        const attName = action.type.substr(PREFIX.length);\n        if (!ATTRIBUTES.has(attName)) {\n            throw Error(`Unknown attribute \"${attName}\"!`);\n        }\n        const attValue = action.data;\n        return Object.assign(state, { [attName]: attValue });\n    },\n\n    setLanguage(language: string): IAction {\n        return { type: \"user:language\", data: language };\n    },\n\n    setNickname(nickname: string): IAction {\n        return { type: \"user:nickname\", data: nickname };\n    }\n}\n","import { IAction, IOrganization } from \"../types\"\n\nconst PREFIX = \"organization:\";\n\nexport default {\n    INITIAL_STATE: [],\n\n    reducer(state: IOrganization[], action: IAction): IOrganization[] {\n        const { type } = action;\n        if (!type.startsWith(PREFIX)) return state;\n\n        const command = action.type.substr(PREFIX.length);\n        switch (command) {\n            case \"set\": return set(state, action.organizations);\n            case \"add\": return add(state, action.organization);\n            case \"update\": return update(state, action.organization);\n            default: throw Error(`Unknown action \"${type}\"!`);\n        }\n    },\n\n    setOrganizations(organizations: IOrganization[]): IAction {\n        return { type: \"organization:set\", organizations };\n    },\n\n    addOrganization(organization: IOrganization): IAction {\n        return { type: \"organization:add\", organization };\n    },\n\n    updateOrganization(organization: IOrganization): IAction {\n        return { type: \"organization:update\", organization };\n    }\n}\n\nfunction set(state: IOrganization[], organizations: IOrganization[]): IOrganization[] {\n    return organizations.slice();\n}\n\nfunction add(state: IOrganization[], organization: IOrganization): IOrganization[] {\n    const newState = state.slice();\n    newState.push(organization);\n    return newState;\n}\n\n\nfunction update(state: IOrganization[], organization: IOrganization): IOrganization[] {\n    return state.map(item => item.id === organization.id ? organization : item);\n}\n","import { IAction, ICarecenter } from \"../types\"\n\nconst PREFIX = \"carecenter:\";\n\nexport default {\n    INITIAL_STATE: [],\n\n    reducer(state: ICarecenter[], action: IAction): ICarecenter[] {\n        const { type } = action;\n        if (!type.startsWith(PREFIX)) return state;\n\n        const command = action.type.substr(PREFIX.length);\n        switch (command) {\n            case \"set\": return set(state, action.carecenters);\n            case \"add\": return add(state, action.carecenter);\n            case \"update\": return update(state, action.carecenter);\n            default: throw Error(`Unknown action \"${type}\"!`);\n        }\n    },\n\n    setCarecenters(carecenters: ICarecenter[]): IAction {\n        return { type: \"carecenter:set\", carecenters };\n    },\n\n    addCarecenter(carecenter: ICarecenter): IAction {\n        return { type: \"carecenter:add\", carecenter };\n    },\n\n    updateCarecenter(carecenter: ICarecenter): IAction {\n        return { type: \"carecenter:update\", carecenter };\n    }\n}\n\nfunction set(state: ICarecenter[], carecenters: ICarecenter[]): ICarecenter[] {\n    return carecenters.slice();\n}\n\nfunction add(state: ICarecenter[], carecenter: ICarecenter): ICarecenter[] {\n    const newState = state.slice();\n    newState.push(carecenter);\n    return newState;\n}\n\nfunction update(state: ICarecenter[], carecenter: ICarecenter): ICarecenter[] {\n    return state.map(\n        item => item.id === carecenter.id ? Object.assign(item, carecenter) : item);\n}\n","import { IStructure, IPatientField } from \"../types\"\r\nimport Intl from \"../tfw/intl\"\r\n\r\nexport default {\r\n    createPatientsFieldsFromStructure(structure: IStructure): { [key: string]: boolean } {\r\n        const patientsFields : { [key: string]: boolean }= {};\r\n        structure.patientFields.forEach((patientField: IPatientField) => {\r\n            patientsFields[patientField.id] = true;\r\n        });\r\n        return patientsFields;\r\n    },\r\n\r\n    createPatientsFieldsCaptionsFromStructure(structure: IStructure): { [key: string]: string } {\r\n        const patientsFieldsCaptions : { [key: string]: string }= {};\r\n        structure.patientFields.forEach((patientField: IPatientField) => {\r\n            patientsFieldsCaptions[patientField.id] = Intl.toText(patientField.caption);\r\n        });\r\n        return patientsFieldsCaptions;\r\n    },\r\n\r\n    getFieldCaption(key:string, structure:IStructure) {\r\n        if( key.charAt(0) !== '#') return key;\r\n        const item: {caption: string, type: string}|undefined =\r\n         structure.formFields[key];\r\n        if( !item ) return key;\r\n        return Intl.toText(item.caption);\r\n    }\r\n}\r\n","import { IAction, IStructure } from \"../types\"\n\nconst PREFIX = \"structure:\";\n\nexport default {\n    INITIAL_STATE: [],\n\n    reducer(state: IStructure[], action: IAction): IStructure[] {\n        const { type } = action;\n        if (!type.startsWith(PREFIX)) return state;\n\n        const command = action.type.substr(PREFIX.length);\n        switch (command) {\n            case \"set\": return set(state, action.structures);\n            case \"add\": return add(state, action.structure);\n            case \"update\": return update(state, action.structure);\n            default: throw Error(`Unknown action \"${type}\"!`);\n        }\n    },\n\n    setStructures(structures: IStructure[]): IAction {\n        return { type: \"structure:set\", structures };\n    },\n\n    addStructure(structure: IStructure): IAction {\n        return { type: \"structure:add\", structure };\n    },\n\n    updateStructure(structure: IStructure): IAction {\n        return { type: \"structure:update\", structure };\n    }\n}\n\nfunction set(state: IStructure[], structures: IStructure[]): IStructure[] {\n    return structures.slice();\n}\n\nfunction add(state: IStructure[], structure: IStructure): IStructure[] {\n    const newState = state.slice();\n    newState.push(structure);\n    return newState;\n}\n\nfunction update(state: IStructure[], structure: IStructure): IStructure[] {\n    return state.map(\n        item => item.id === structure.id ? Object.assign(item, structure) : item);\n}\n","import { IAction, IStatsConfig } from \"../types\"\nimport castString from \"../tfw/converter/string\"\nimport castBoolean from \"../tfw/converter/boolean\"\n\nconst PREFIX = \"stats-config:\";\n\nexport default {\n    INITIAL_STATE: {\n        statsType: \"consultations\",\n        dateMin: lastMonth(),\n        dateMax: today(),\n        patientsFields: {\n            birthday: true,\n            size: false,\n            nationality: true\n        },\n        patientsFieldsCaptions: {\n            birthday: \"Date de naissance\",\n            size: \"Taille\",\n            nationality: \"Nationalité\"\n        },\n        carecenter: {\n            id: 0,\n            organizationId: 0,\n            structureId: 0,\n            patientsCount: 0,\n            consultationsCount: 0,\n            name: \"\",\n            code: \"\"\n        }\n    },\n\n    reducer(state: IStatsConfig, action: IAction): IStatsConfig {\n        const { type } = action;\n        if (!type.startsWith(PREFIX)) return state;\n\n        switch (action.type.substr(PREFIX.length)) {\n            case \"setType\": return setType(state, action);\n            case \"setDateMin\": return setDateMin(state, action);\n            case \"setDateMax\": return setDateMax(state, action);\r\n            case \"setPatientsFields\": return setPatientsFields(state, action);\r\n            case \"setPatientField\": return setPatientField(state, action);\r\n            default: throw Error(`Unknown action \"${type}\"!`);\r\n        }\n    },\n\n    setType(statsType: \"patients\" | \"consultations\"): IAction {\n        return { type: \"stats-config:setType\", statsType };\n    },\n\n    setDateMin(date: number): IAction {\n        return { type: \"stats-config:setDateMin\", date };\n    },\n\n    setDateMax(date: number): IAction {\n        return { type: \"stats-config:setDateMax\", date };\n    },\n\n    setPatientsFields(fields: { [key: string]: boolean }): IAction {\n        return { type: \"stats-config:setPatientsFields\", fields };\n    },\n\n    setPatientField(fieldName: string, fieldVisibility: boolean): IAction {\n        return { type: \"stats-config:setPatientField\", fieldName, fieldVisibility };\n    }\n}\n\nfunction setType(state: IStatsConfig, action: IAction): IStatsConfig {\n    return {\n        ...state,\n        statsType: action.statsType || \"consultations\"\n    };\n}\n\nfunction setDateMin(state: IStatsConfig, action: IAction): IStatsConfig {\n    return {\n        ...state,\n        dateMin: action.date\n    };\n}\n\nfunction setDateMax(state: IStatsConfig, action: IAction): IStatsConfig {\n    return {\n        ...state,\n        dateMax: action.date\n    };\n}\n\nfunction setPatientsFields(state: IStatsConfig, action: IAction): IStatsConfig {\n    return {\n        ...state,\n        patientsFields: action.fields || {}\n    };\n}\n\nfunction setPatientField(state: IStatsConfig, action: IAction): IStatsConfig {\n    if (typeof action.fieldName !== 'string') {\n        throw Error(`action must have an attribute \"fieldName\" of type \"string\" but we found \"${typeof action.fieldName}\"`);\n    }\n    const fieldName: string = castString(action.fieldName, \"\");\n    const fieldVisibility: boolean = castBoolean(action.fieldVisibility, false);\n    return {\n        ...state,\n        patientsFields: {\n            ...state.patientsFields,\n            [fieldName]: fieldVisibility\n        }\n    };\n}\n\n\nfunction today() {\n    return Date.now();\n}\n\nfunction lastMonth() {\n    const today = new Date();\n    if (today.getDate() !== 1) {\n        const firstDayOfCurrentMonth = new Date(today.getFullYear(), today.getMonth(), 1);\n        return firstDayOfCurrentMonth.getTime();\n    } else {\n        const lastMonth = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());\n        return lastMonth.getTime();\n    }\n}\n","import { IAction, IStatsConfig } from \"../types\"\nimport castString from \"../tfw/converter/string\"\nimport castBoolean from \"../tfw/converter/boolean\"\n\nconst PREFIX = \"stats:\";\n\nexport default {\n    INITIAL_STATE: [],\n\n    reducer(state: IStatsConfig[], action: IAction): IStatsConfig[] {\n        const { type } = action;\n        if (!type.startsWith(PREFIX)) return state;\n\n        switch (action.type.substr(PREFIX.length)) {\n            case \"addStat\": return addStat(state, action);\n            default: throw Error(`Unknown action \"${type}\"!`);\r\n        }\n    },\n\n    addStat(stat: IStatsConfig): IAction {\n        return { type: \"stats:addStat\", stat };\n    }\n}\n\nfunction addStat(state: IStatsConfig[], action: IAction): IStatsConfig[] {\n    const stats = state.stats.slice();\n    stats.push( action.stat );\n    return stats;\n}\n","import { IStatsConfig } from \"../types\"\r\n\r\nexport default {\r\n    statsConfig(obj: IStatsConfig): string {\r\n        return `${obj.statsType}/${obj.dateMin}-${obj.dateMax}`;\r\n    }\r\n}\r\n","/**\n * The full state of the application is stored and managed here.\n */\nimport { createStore } from 'redux'\nimport User from \"./user\";\nimport Organizations from \"./organizations\"\nimport Carecenters from \"./carecenters\"\nimport Structure from \"../structure\"\nimport Structures from \"./structures\"\nimport StatsConfig from \"./stats-config\"\nimport Stats from \"./stats\"\nimport Hash from \"../util/hash\"\nimport { IState, IAction, IStatsConfig } from \"../types\"\n\nfunction dispatch(action: IAction) {\n    store.dispatch(action);\n}\n\nconst INITIAL_STATE: IState = {\n    user: User.INITIAL_STATE,\n    organizations: Organizations.INITIAL_STATE,\n    carecenters: Carecenters.INITIAL_STATE,\n    structures: Structures.INITIAL_STATE,\n    statsConfig: StatsConfig.INITIAL_STATE,\n    stats: Stats.INITIAL_STATE\n};\n\nfunction reducer(state: IState | undefined = INITIAL_STATE, action: IAction): IState {\n    console.log(\"state =\", state);\n    switch (action.type) {\n        case \"initStatsConfig\": return initStatsConfig(state, action);\n        case \"addStat\": return addStat(state, action);\n        case \"removeStat\": return removeStat(state, action);\n        default: return {\n            user: User.reducer(state.user, action),\n            stats: Stats.reducer(state.stats, action),\n            organizations: Organizations.reducer(state.organizations, action),\n            carecenters: Carecenters.reducer(state.carecenters, action),\n            structures: Structures.reducer(state.structures, action),\n            statsConfig: StatsConfig.reducer(state.statsConfig, action)\n        };\n    }\n}\n\nconst store = createStore(reducer);\n\nfunction addStat(state: IState, action: IAction): IState {\n    const h = Hash.statsConfig(state.statsConfig);\n    const stats = state.stats.filter(s => Hash.statsConfig(s) !== h);\n    stats.push({ ...state.statsConfig });\n    return { ...state, stats };\n}\n\nfunction removeStat(state: IState, action: IAction): IState {\n    const stats = state.stats.filter(s => Hash.statsConfig(s) !== action.key);\n    return { ...state, stats };\n}\n\nfunction initStatsConfig(state: IState, action: IAction): IState {\n    const carecenterId = action.carecenterId;\n    const carecenter = state.carecenters.find(c => c.id === carecenterId);\n    if (!carecenter) {\n        throw Error(`There is no Carecenter with id=${carecenterId}!`);\n    }\n    const structureId = carecenter.structureId;\n    if (typeof structureId !== 'number') {\n        throw Error('Missing attribute number \"structureId\"!');\n    }\n    const structure = state.structures.find(s => s.id === structureId);\n    if (!structure) {\n        throw Error(`There is no structure with id ${structureId}!`);\n    }\n    return {\n        ...state,\n        statsConfig: {\n            ...state.statsConfig,\n            carecenter,\n            patientsFields: Structure.createPatientsFieldsFromStructure(structure),\n            patientsFieldsCaptions: Structure.createPatientsFieldsCaptionsFromStructure(structure)\n        }\n    }\n}\n\nexport default {\n    store, dispatch,\n\n    User, Organizations, Carecenters, Structures, StatsConfig,\n\n    initStatsConfig(carecenterId: number): IAction {\n        return { type: \"initStatsConfig\", carecenterId };\n    },\n    addStat(): IAction {\n        return { type: \"addStat\" };\n    },\n    removeStat(key: string): IAction {\n        return { type: \"removeStat\", key };\n    }\n}\n","import WebService from \"../tfw/web-service\"\n\nexport default {\n    async list() {\n        return await WebService.exec(\"orga.list\");\n    }\n}\n","import WebService from \"../tfw/web-service\"\nimport { ICarecenter } from \"../types\"\n\ninterface IServiceCarecenter {\n    id: number;\n    name: string;\n    code: string;\n    patientsCount: number;\n    consultationsCount: number;\n    structure: number;\n}\n\nexport default {\n    async list( organizationId: number) : Promise<ICarecenter[]> {\n        const carecenters = await WebService.exec(\"carecenter.list\", organizationId);\n        return carecenters.map( (carecenter: IServiceCarecenter) => ({\n            id: carecenter.id,\n            name: carecenter.name,\n            code: carecenter.code,\n            patientsCount: carecenter.patientsCount,\n            consultationsCount: carecenter.consultationsCount,\n            structureId: carecenter.structure,\n            organizationId\n        }));\n    }\n}\n","import Intl from \"../tfw/intl\";\r\nconst _ = Intl.make(require(\"./parser.yaml\"));\r\n\r\n\r\n/**\r\n * Le fichier `types.org` définit tous  les types de données complexe.\r\n * Il  n'y a  pas  de type  très contraignant,  tous  les textes  sont\r\n * libres, mais on propose des listes pour faciliter la saisie. Chaque\r\n * élément  de cette  liste est  muni d'un  identifiant (précédé  d'un\r\n * dièse `#`).\r\n * Un type peut être hiérarchique. Par exemple, une adresse propose un\r\n * pays, une région,  un district, ... Les  propositions dépendent des\r\n * choix  précédents. Ainsi,  la liste  des propositions  de districts\r\n * dépend de la région sélectionnée.\r\n *\r\n * Le  parsing du  fichier `types.org`  se  fait ligne  par ligne.  On\r\n * ignore tous  les espaces/tabulations en  début de ligne.  Le nombre\r\n * d'astérisques  `*`  qui  commencent  une ligne  indique  le  niveau\r\n * hiérarchique.\r\n * Au  niveau 1,  on trouve  l'identifiant du  type qui  doit toujours\r\n * commencer par un dièse `#`.\r\n *\r\n * Voici un  exemple de  fichier en  entrée et de  comment on  doit le\r\n * traduire.\r\n * ```\r\n * #GENDER\r\n * * #H Homme\r\n * * #F Femme\r\n *\r\n * #LOCALIZATION\r\n * * Cameroun\r\n * ** Littoral\r\n * *** District 9\r\n * **** Village 1\r\n * **** Village 2\r\n * **** Village 3\r\n * *** Un peu plus loin\r\n * **** Village A\r\n * **** Village B\r\n * ** Centre\r\n * *** Pas tout près\r\n * **** Village Toto\r\n * *** Au fin fond du...\r\n * **** Village Alpha\r\n * **** Village Beta\r\n * **** Village Gama\r\n * ```\r\n *\r\n * ```\r\n * {\r\n *   \"#GENDER\": {\r\n *     \"#H\": { \"caption\": \"Homme\" },\r\n *     \"#F\": { \"caption\": \"Femme\" }\r\n *   },\r\n *   \"#LOCALIZATION\": {\r\n *     \"Cameroun\": { \"caption\": \"Cameroun\", \"children\": {\r\n *       \"Littoral\": { \"caption\": \"Littoral\", \"children\": {\r\n *         ...\r\n *       }},\r\n *       \"Centre\": { \"caption\": \"Centre\", \"children\": {\r\n *         ...\r\n *       }},\r\n *       ...\r\n *     }}\r\n *   }\r\n * }\r\n * ```\r\n */\r\n\r\n\r\nconst RX_LINE = /^(#[A-Z0-9-]+)?([^\\(@]*)(\\([^\\)]*\\)\\+?)?(@[A-Z0-9,-]+)?/;\r\n\r\n\r\nfunction parse(code: string) {\r\n    const types = {};\r\n    const levels = [types];\r\n    if (typeof code !== 'string') code = `${code}`;\r\n    code.split('\\n').forEach(function(line, lineNumber) {\r\n        try {\r\n            line = line.trim();\r\n            // Ignorer les lignes vides.\r\n            if (line.length === 0) return;\r\n            // Ignorer les commentaires.\r\n            if (line.substr(0, 2) === '//') return;\r\n            if (line.charAt(0) !== '*') throw _('err-1');\r\n\r\n            // Calculer le niveau hiérarchique `level`.\r\n            const level = computeLevel(line);\r\n            line = line.substr(level).trim();\r\n\r\n            if (level > levels.length) {\r\n                throw _('err-2', line, levels.length - 1, level);\r\n            }\r\n            while (levels.length > level) {\r\n                levels.pop();\r\n            }\r\n            const item = parseLine(line);\r\n            if (typeof levels[levels.length - 1][item.id] !== 'undefined') {\r\n                throw _('err-3', item.id);\r\n            }\r\n            levels[levels.length - 1][item.id] = item;\r\n            levels.push(item.children || {});\r\n        }\r\n        catch (ex) {\r\n            throw { lineNumber: lineNumber + 1, message: ex };\r\n        }\r\n    });\r\n    return types;\r\n};\r\n\r\n\r\n/**\r\n * @param   {string} line - Line to parse.\r\n * @returns {number} Number of leading '*' in the line.\r\n */\r\nfunction computeLevel(line: string): number {\r\n    let level = 0;\r\n    while (line.charAt(0) == '*') {\r\n        line = line.substr(1);\r\n        level++;\r\n    }\r\n    return level;\r\n}\r\n\r\n\r\nfunction parseLine(line: string) {\r\n    const item = { children: {} };\r\n    const m = RX_LINE.exec(line.trim());\r\n    if (m[2]) {\r\n        item.caption = m[2].trim();\r\n    }\r\n    if (m[1]) {\r\n        item.id = m[1].trim();\r\n    } else {\r\n        item.id = item.caption.toUpperCase();\r\n    }\r\n    if (m[3]) {\r\n        item.type = m[3].substr(1, m[3].length - 2).trim();\r\n    }\r\n    if (m[4]) {\r\n        item.tags = m[4].trim().substr(1).split(',').map(function(v) { return v.trim(); });\r\n    }\r\n    return item;\r\n}\r\n\r\n\r\n/**\r\n * @param {object} forms\r\n * {\r\n *   CONCLUSION: {\r\n *     caption: \"Conclusion\",\r\n *     children: {\r\n *       \"#SURGERY-GYN\": {\r\n *         caption: \"Chirurgie\",\r\n *         id: \"#SURGERY-GYN\",\r\n *         type: \"#SURGERY-GYN\"\r\n *       }\r\n *     }\r\n *   },\r\n *   ...\r\n * }\r\n * @return `[{ id:\"#SURGERY-GYN\", caption:\"Chirurgie\", path:[\"Conclusion\", \"Chirurgie\"] }, ...]`\r\n */\r\nfunction flattenFormsFields(forms) {\r\n    var list = [];\r\n    recursiveFlattenFormsFields(forms, list, []);\r\n    list.sort(function(a, b) {\r\n        var captionA = a.caption;\r\n        var captionB = b.caption;\r\n        if (captionA < captionB) return -1;\r\n        if (captionA > captionB) return +1;\r\n        return 0;\r\n    });\r\n    return list;\r\n}\r\n\r\n\r\nfunction recursiveFlattenFormsFields(children, list, path) {\r\n    Object.keys(children).forEach(function(key) {\r\n        var child = children[key];\r\n        if (typeof child.id === 'string' && child.id.charAt(0) === '#') {\r\n            // Leave.\r\n            list.push({\r\n                id: child.id,\r\n                caption: child.caption,\r\n                path: path.slice()\r\n            });\r\n        }\r\n        else if (child.children) {\r\n            // Node.\r\n            path.push(child.caption);\r\n            recursiveFlattenFormsFields(child.children, list, path);\r\n            path.pop();\r\n        }\r\n    });\r\n}\r\n\r\n\r\nexport default { parse, flattenFormsFields }\r\n","import WebService from \"../tfw/web-service\"\nimport Parser from \"../structure/parser\"\nimport Intl from \"../tfw/intl\"\nimport castString from \"../tfw/converter/string\"\nimport { IStructure, IPatientField } from \"../types\"\n\nexport interface IStructureService {\n    id: number;\n    name: string;\n    exams: string;\n    vaccins: string;\n    patient: string;\n    forms: string;\n    types: string;\n}\n\n\nexport default {\n    async list(organizationId: number) {\n        const structures: IStructureService[] =\n            await WebService.exec(\"structure.list\", organizationId);\n        return structures.map((structure: IStructureService) => (\r\n            {\n                id: structure.id,\n                organizationId,\n                name: structure.name,\n                patientFields: parsePatient(structure.patient),\n                formFields: parseFormFields(structure),\n                exams: parse(structure.exams),\n                vaccins: parse(structure.vaccins),\n                forms: parse(structure.forms),\n                types: parse(structure.types),\n                sources: {\n                    exams: structure.exams,\n                    vaccins: structure.vaccins,\n                    patient: structure.patient,\n                    forms: structure.forms,\n                    types: structure.types\n                }\n            }\r\n        ));\n    }\n}\n\n\nfunction parse(def: string) {\n    try {\n        return Parser.parse(def);\n    }\n    catch (ex) {\n        console.error(\"[parsePatient] \", ex);\n        console.log(def);\n    }\n    return null;\n}\n\nfunction parsePatient(stringifiedPatientDef: string): IPatientField[] {\n    try {\n        const raw = Parser.parse(stringifiedPatientDef);\n        const patients: IPatientField[] = Object.keys(raw).map((id: string) => {\n            const patient = raw[id];\n            return {\n                id,\n                type: patient.type,\n                caption: Intl.toIntl(patient.caption)\n            }\n        });\n        return patients;\n    }\n    catch (ex) {\n        console.error(\"[parsePatient] \", ex);\n    }\n    return [];\n}\n\ninterface IFlatField {\n    type: string;\n    caption: { [key: string]: string };\n}\n\nfunction parseFormFields(structure: IStructureService): { [key: string]: IFlatField } {\n    const result: { [key: string]: IFlatField } = {};\n    const fringe = [parse(structure.forms)];\n    while (fringe.length > 0) {\n        const item = fringe.shift();\n        for (const name of Object.keys(item)) {\n            const value = item[name];\n            result[name] = { caption: Intl.toIntl(value.caption) };\n            if (value.type) result[name].type = value.type;\n            if (value.children) {\n                fringe.push(value.children);\n            }\n        }\n    }\n    return result;\n}\n","/**\n * @export {function} .tokenize\n * @param {string} source - Stringification of a permissive JSON object.\n * @return {array} Array of tokens. A token is an object like this: `{}`.\n */\nconst OBJ_OPEN = 1;\nconst OBJ_CLOSE = 2;\nconst ARR_OPEN = 3;\nconst ARR_CLOSE = 4;\nconst STRING = 5;\nconst NUMBER = 6;\nconst SPECIAL = 7;  // true, false, null or undefined.\nconst COLON = 8;\n\nconst TYPE_NAMES = [\n    \"???\",\n    \"OBJ_OPEN\", \"OBJ_CLOSE\", \"ARR_OPEN\", \"ARR_CLOSE\",\n    \"STRING\", \"NUMBER\", \"SPECIAL\", \"COLON\"\n];\n\nexport default {\n    OBJ_OPEN,\n    OBJ_CLOSE,\n    ARR_OPEN,\n    ARR_CLOSE,\n    STRING,\n    NUMBER,\n    SPECIAL,  // true, false, null or undefined.\n    COLON,\n    tokenize(source: string) {\n        const ctx = new Context();\n        return ctx.tokenize(source);\n    },\n    getTypeName: function(type: string) { return TYPE_NAMES[type]; }\n};\n\nconst RX_DECIMAL = /^-?(\\.[0-9]+|[0-9]+(\\.[0-9]+)?)([eE]-?[0-9]+)?$/;\nconst RX_HEXA = /^-?0x[0-9a-f]+$/i;\nconst RX_OCTAL = /^-?0o[0-7]+$/i;\nconst RX_BINARY = /^-?0b[01]+$/i;\n\ninterface IToken {\n    type: number,\n    index: number,\n    value: string | number\n}\n\n\nclass Context {\n    private readonly eaters: (() => void)[]\n    private source: string = ''\n    private index: number = 0\n    private end: number = 0\n    private tokens: IToken[] = []\n\n    constructor() {\n        this.eaters = [\n            this.eatBlanks,\n            this.eatSymbol,\n            this.eatComment,\n            this.eatString,\n            this.eatIdentifier\n        ];\n    }\n\n    tokenize(source: string) {\n        this.source = source;\n        this.end = source.length;\n        this.index = 0;\n        this.tokens = [];\n\n        while (this.index < this.end) {\n            const currentSourceIndex = this.index;\n            for (let eaterIndex = 0; eaterIndex < this.eaters.length; eaterIndex++) {\n                const eater = this.eaters[eaterIndex];\n                eater();\n                if (this.index !== currentSourceIndex) break;\n            }\n            if (this.index === currentSourceIndex) {\n                // No eater has been pleased with this char.\n                this.fail(`Unexpected token at pos ${this.index}:\\n${source.substr(this.index, 80)}`);\n            }\n        }\n\n        return this.tokens;\n    }\n\n    fail(msg: string) {\n        if (typeof msg === 'undefined') msg = \"Invalid char at \" + this.index + \"!\"\n\n        throw { index: this.index, source: this.source, message: msg }\n    }\n\n    eos() {\n        return this.index >= this.end\n    }\n\n    peek() {\n        return this.eos() ? null : this.source[this.index];\n    }\n\n    next() {\n        return this.eos() ? null : this.source[this.index++];\n    }\n\n    back() { if (this.index > 0) this.index--; };\n\n    addToken(type: number, index: number = -1, value: any = '') {\n        if (index === -1) index = this.index;\n        this.tokens.push({ type, index, value })\n    }\n\n    eatBlanks = () => {\n        while (\" \\t\\n\\r\".indexOf(this.peek() || '?') !== -1) this.index++;\n    }\n\n    eatSymbol = () => {\n        let tkn = null;\n        const c = this.peek();\n        switch (c) {\n            case '{': tkn = OBJ_OPEN; break;\n            case '}': tkn = OBJ_CLOSE; break;\n            case '[': tkn = ARR_OPEN; break;\n            case ']': tkn = ARR_CLOSE; break;\n            case ':': tkn = COLON; break;\n            case ',':\n            // The comma is not mandatory.\n            this.index++;\n            return;\n        }\n        if (tkn) {\n            this.addToken(tkn);\n            this.index++;\n        }\n    }\n\n    eatComment = () => {\n        if (this.peek() !== '/') return;\n        this.index++;\n        const c = this.next();\n        if (c == '/') {\n            // Single line comment.\n            const endOfSingleComment = this.source.indexOf('\\n', this.index);\n            if (endOfSingleComment === -1) {\n                this.index = this.end;\n            } else {\n                this.index = endOfSingleComment + 1;\n            }\n        }\n        else if (c == '*') {\n            // Multi line comment.\n            const endOfComment = this.source.indexOf('*/', this.index);\n            if (endOfComment === -1) {\n                this.index = this.end;\n            } else {\n                this.index = endOfComment + 1;\n            }\n        }\n        else {\n            this.fail(\"'/' looks like a comment, but it is not!\");\n        }\n    }\n\n    eatString = () => {\n        const start = this.index;\n        const quote = this.peek();\n        if (quote !== '\"' && quote !== \"'\") return;\n        this.index++;\n        let escape = false;\n        let str = '';\n        while (!this.eos()) {\n            let c = this.next();\n            if (escape) {\n                escape = false;\n                if (c === 'n') c = '\\n';\n                else if (c === 'r') c = '\\r';\n                else if (c === 't') c = '\\t';\n                str += c;\n            }\n            else if (c === \"\\\\\") {\n                escape = true;\n            }\n            else if (c === quote) {\n                this.addToken(STRING, start, str);\n                return;\n            }\n            else {\n                str += c;\n            }\n        }\n        this.index = start;\n        this.fail(\"Missing en of string\");\n    }\n\n    eatIdentifier = () => {\n        const start = this.index;\n        let c = this.peek() || '?';\n        if (\" \\t\\n\\r,:[]{}/\".indexOf(c) !== -1) return;\n        this.index++;\n        let str: string | null | undefined | boolean = c;\n        while (!this.eos()) {\n            c = this.peek() || '?';\n            if (\" \\t\\n\\r,:[]{}/\".indexOf(c) !== -1) break;\n            str += c;\n            this.index++;\n        }\n        if (RX_DECIMAL.test(str)) {\n            this.addToken(NUMBER, start, parseFloat(str));\n        }\n        else if (RX_HEXA.test(str)) {\n            this.addToken(NUMBER, start, parseInt(str, 16));\n        }\n        else if (RX_OCTAL.test(str)) {\n            if (str.charAt(0) == '-') {\n                str = \"-\" + str.substr(3);\n            } else {\n                str = str.substr(2);\n            }\n            this.addToken(NUMBER, start, parseInt(str, 8));\n        }\n        else if (RX_BINARY.test(str)) {\n            if (str.charAt(0) == '-') {\n                str = \"-\" + str.substr(3);\n            } else {\n                str = str.substr(2);\n            }\n            this.addToken(NUMBER, start, parseInt(str, 2));\n        }\n        else {\n            let type = SPECIAL;\n            if (str === 'null') str = null;\n            else if (str === 'undefined') str = undefined;\n            else if (str === 'true') str = true;\n            else if (str === 'false') str = false;\n            else type = STRING;\n            this.addToken(type, start, str);\n        }\n    }\n}\n","import Tokenizer from \"./tokenizer\"\n\nexport default { parse, isValid }\n\nfunction isValid(text: string) {\n    try {\n        parse(text)\n        return true\n    }\n    catch(ex) {\n        return false\n    }\n}\n\nfunction parse(text: string) {\n    try {\n        const tokens = Tokenizer.tokenize(text);\n        const parser = new Parser(tokens);\n        const result = parser.parse();\n        return result;\n    }\n    catch (ex) {\n        if (typeof ex.type === 'number') {\n            throw ex;\n        } else {\n            throw ex;\n        }\n    }\n};\n\n\ninterface IToken {\n    index: number,\n    type: number,\n    value: any\n}\n\n\nclass Parser {\n    private index = 0\n\n    constructor(private tokens: IToken[]) {}\n\n    peek() {\n        return this.tokens[this.index];\n    }\n\n    next() {\n        return this.tokens[this.index++];\n    }\n\n    back() {\n        this.index = Math.max(0, this.index - 1);\n    }\n\n    parse(): any {\n        var tkn = this.next();\n\n        switch (tkn.type) {\n            case Tokenizer.OBJ_OPEN:\n                return this.parseObject();\n            case Tokenizer.ARR_OPEN:\n                return this.parseArray();\n            case Tokenizer.STRING:\n            case Tokenizer.NUMBER:\n            case Tokenizer.SPECIAL:\n                return tkn.value;\n        }\n        this.back();\n        throw this.fail(tkn);\n    }\n\n    parseArray() {\n        var start = this.index;\n        var arr = [];\n        var tkn;\n        while (undefined !== (tkn = this.peek())) {\n            if (tkn.type === Tokenizer.ARR_CLOSE) {\n                this.next();\n                return arr;\n            }\n            arr.push(this.parse());\n        }\n        throw this.fail(`Opening braket at position ${start} has no corresponding closing one!`, start);\n    }\n\n    parseObject() {\n        let start = this.index;\n        const obj: any = {};\n        let tkn;\n        let indexForMissingKey = 0;\n        while (undefined !== (tkn = this.peek())) {\n            if (tkn.type === Tokenizer.OBJ_CLOSE) {\n                this.next();\n                return obj;\n            }\n            const key = this.parse();\n            tkn = this.peek();\n            if (tkn.type === Tokenizer.OBJ_CLOSE) {\n                obj[indexForMissingKey++] = key;\n                this.next();\n                return obj;\n            }\n            else if (tkn.type === Tokenizer.COLON) {\n                this.next();\n                const val = this.parse();\n                obj[key] = val;\n            }\n            else {\n                // Missing key.\n                obj[indexForMissingKey++] = key;\n            }\n        }\n        throw this.fail(\"Opening brace at position \" + start + \" has no corresponding closing one!\", start);\n    }\n\n    fail(tkn: IToken | string, index: number = -1) {\n        if (index < 0) index = this.index\n        if (typeof tkn === 'string') {\n            return { message: tkn, index: index };\n        }\n        return {\n            index: tkn.index,\n            message: \"Unexpected token \" + Tokenizer.getTypeName(tkn.type) + \" at position \" + tkn.index + \"!\"\n        };\n    }\n}\n","export default {\n    saveAs(blob: Blob, fileName: string) {\n        const url = window.URL.createObjectURL(blob);\n        const anchorElem = document.createElement(\"a\");\n\n        anchorElem.style.display = \"none\";\n        anchorElem.href = url;\n        anchorElem.download = fileName;\n\n        document.body.appendChild(anchorElem);\n        anchorElem.click();\n\n        document.body.removeChild(anchorElem);\n\n        // On Edge, revokeObjectURL should be called only after\n        // a.click() has completed, atleast on EdgeHTML 15.15048\n        setTimeout(function() {\n            window.URL.revokeObjectURL(url);\n        }, 5000);\n    }\n}\n","export default {\n    padNumber(value: number, size: number = 6, fillWith: string = '0'): string {\n        let text = `${value}`;\n        while (text.length < size) {\n            text = fillWith.charAt(0) + text;\n        }\n        return text;\n    },\n\n    clamp(value: number, min: number = 0, max: number = 1) {\n        if (value < min) return min;\n        if (value > max) return max;\n        return value;\n    },\n\n    loadTextFromFile(file: File): Promise<string> {\n        return new Promise((resolve, reject) => {\n            const reader: FileReader = new FileReader();\n            reader.onload = (data) => {\n                const content = `${data.target.result}`;\n                resolve(content);\n            };\n            reader.onerror = (err) => {\n                reject(err);\n            };\n            reader.readAsText(file);\n        })\n    },\n\n    loadTextFromURL(url: string): Promise<string> {\n        return new Promise((resolve, reject) => {\n            fetch(url)\n                .then((response: Response) => {\n                    if (!response.ok) {\n                        reject(`Error ${response.status}: ${response.statusText}!`);\n                    }\n                    return response.text();\n                })\n                .then(resolve)\n                .catch(reject);\n        });\n    },\n\n    loadJsonFromURL(url: string): Promise<any> {\n        return new Promise((resolve, reject) => {\n            fetch(url)\n                .then((response: Response) => {\n                    return response.json();\n                })\n                .then(resolve)\n                .catch(reject);\n        });\n    }\n}\n","import React from \"react\"\r\nimport Button from \"../button\"\r\n\r\nimport \"./input-file.css\"\r\n\r\ninterface IInputFileProps {\r\n    label?: string;\r\n    icon?: string;\r\n    wide?: boolean;\r\n    wait?: boolean;\r\n    flat?: boolean;\r\n    small?: boolean;\r\n    warning?: boolean;\r\n    enabled?: boolean;\r\n    multiple?: boolean;\r\n    accept?: string;  // Ex.: \"image/png,image/jpeg\", \".png,.jpg\", \"image/*\", ... See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file#Unique_file_type_specifiers\r\n    classes?: string[] | string;\r\n    onClick?: (files: FileList) => void;\r\n}\r\n\r\nexport default class InputFile extends React.Component<IInputFileProps, {}> {\r\n    private readonly refInput: React.RefObject<HTMLInputElement> = React.createRef();\r\n\r\n    constructor( props: IInputFileProps ) {\r\n        super( props );\r\n        this.handleClick = this.handleClick.bind( this );\r\n        this.handleFileChange = this.handleFileChange.bind( this );\r\n    }\r\n\r\n    static readFileAsText(file: File): Promise<string> {\r\n        return new Promise((resolve, reject) => {\r\n            const reader: FileReader = new FileReader();\r\n            reader.onload = (data) => {\r\n                const content = data.target.result;\r\n                resolve(content);\r\n            };\r\n            reader.onerror = (err) => {\r\n                reject(err);\r\n            };\r\n            reader.readAsText(file);\r\n        })\r\n    }\r\n\r\n    handleFileChange(evt: React.ChangeEvent<HTMLInputElement>) {\r\n        if( !evt.target ) return;\r\n\r\n        const handler = this.props.onClick;\r\n        if (typeof handler !== 'function') return;\r\n\r\n        try {\r\n            const input = evt.target as HTMLInputElement;\r\n            const files = input.files;\r\n            if( !files ) return;\r\n            handler(files);\r\n        } catch(ex) {\r\n            console.error(\"Error in handleFileChange(): \", );\r\n            console.error(ex);\r\n        }\r\n    }\r\n\r\n    handleClick() {\r\n        const input = this.refInput.current;\r\n        if( !input ) return;\r\n        input.click();\r\n    }\r\n\r\n    render() {\r\n        const p = this.props;\r\n        const classes = [\"tfw-view-InputFile\"];\r\n        if( p.wide === true ) classes.push(\"wide\");\r\n\r\n        return (<div className={classes.join(\" \")}>\r\n            <Button\r\n                label={p.label}\r\n                icon={p.icon}\r\n                wide={p.wide}\r\n                wait={p.wait}\r\n                flat={p.flat}\r\n                small={p.small}\r\n                warning={p.warning}\r\n                enabled={p.enabled}\r\n                classes={p.classes}\r\n                onClick={this.handleClick}/>\r\n            <input\r\n                ref={this.refInput}\r\n                type=\"file\"\r\n                accept={p.accept}\r\n                multiple={p.multiple === true}\r\n                onChange={this.handleFileChange} />\r\n        </div>)\r\n    }\r\n}\r\n","import * as React from \"react\"\nimport castArray from \"../converter/array\"\nimport castBoolean from \"../converter/boolean\"\nimport TouchableBehavior from \"../behavior/touchable\"\nimport \"./touchable.css\"\n\ninterface ITouchableProps {\n    enabled?: boolean;\n    onClick?: ()=>void;\n    title?: string;\n    classNames?: string[];\n    color?: string;\n    children?: React.ReactElement<any>|React.ReactElement<any>[];\n}\n\nexport default class Touchable extends React.Component<ITouchableProps, {}> {\n    readonly touchable: TouchableBehavior;\n    private ref = React.createRef();\n\n    constructor(props: ITouchableProps) {\n        super(props);\n        this.handleClick = this.handleClick.bind(this);\n        this.touchable = new TouchableBehavior({onTap: this.handleClick, color: props.color});\n    }\n\n    componentDidMount() {\n        const element = this.ref.current;\n        if (!element) return;\n        this.touchable.element = element;\n    }\n\n    handleClick() {\n        const handler = this.props.onClick;\n        if( typeof handler === 'function') {\n            handler();\n        }\n    }\n\n    render() {\n        const p = this.props;\n        const enabled = castBoolean(p.enabled, true);\n        const classes = [\"tfw-view-touchable\"].concat(castArray(p.classNames));\n        if( enabled ) classes.push(\"enabled\");\n        return <div ref={this.ref}\n                tabIndex={0}\n                className={classes.join(\" \")}\n                title={p.title}>{\n            p.children\n        }</div>\n    }\n}\n","import React from \"react\"\nimport Icon from '../icon'\nimport Touchable from '../touchable'\n\nimport \"./expand.css\"\n\ninterface IExpandProps {\n    label: string,\n    value: boolean,\n    onValueChange: (value: boolean) => void\n}\n\nexport default class Expand extends React.Component<IExpandProps, {}> {\n    handleValueChange = () => {\n        this.props.onValueChange(!this.props.value)\n    }\n\n    render() {\n        const classes = [\"tfw-view-Expand\"]\n        if (this.props.value) {\n            classes.push(\"expand\")\n        }\n\n        return (<div className={classes.join(' ')}>\n            <Touchable classNames={[\"head\"]} onClick={this.handleValueChange}>\n                <div className=\"icons\">\n                    <Icon content=\"plus-o\" size={24}/>\n                    <Icon content=\"minus-o\" size={24}/>\n                </div>\n                <div>{this.props.label}</div>\n            </Touchable>\n            <div className=\"body\">{\n                this.props.children\n            }</div>\n        </div>)\n    }\n}\n","type Action = (...args: any[]) => void;\r\n\r\n/**\r\n * The function to call as much as you want. It will perform the debouce for you.\r\n * Put in the same args as the `action` function.\r\n *\r\n * * action -  Action to call. Two consecutive actions cannot be  called if there is\r\n * less than `delay` ms between them.\r\n * * delay - Number of milliseconds.\r\n */\r\nexport default function (action: Action, delay: number): Action {\r\n    let timer: number = 0;\r\n\r\n    return function(this: { delay: number }, ...args: any[]) {\r\n        if (timer) window.clearTimeout(timer);\r\n        timer = window.setTimeout(() => {\r\n            timer = 0;\r\n            action(...args);\r\n        }, delay) as number;\r\n    }\r\n}\r\n","import * as React from \"react\"\nimport \"../theme.css\"\nimport \"./input-date.css\"\nimport castInteger from \"../converter/integer\"\nimport castBoolean from \"../converter/boolean\"\nimport castString from \"../converter/string\"\nimport Debouncer from \"../debouncer\"\n\nimport Intl from \"../intl\"\nconst _ = Intl.make(require(\"./input-date.yaml\"));\n\ninterface INumberSlot {\n    (value: number): void;\n}\n\ninterface IInputProps {\n    label?: string;\n    value?: number;\n    wide?: boolean;\n    focus?: boolean;\n    onChange?: INumberSlot\n}\n\ninterface IInputState {\n    error?: string;\n}\n\nexport default class Input extends React.Component<IInputProps, IInputState> {\n    readonly inputDay: React.RefObject<HTMLInputElement>;\n    readonly inputMonth: React.RefObject<HTMLSelectElement>;\n    readonly inputYear: React.RefObject<HTMLInputElement>;\n\n    constructor(props: IInputProps) {\n        super(props);\n        this.state = {};\n        this.handleChange = Debouncer(this.handleChange.bind(this), 300);\n        this.inputDay = React.createRef();\n        this.inputMonth = React.createRef();\n        this.inputYear = React.createRef();\n    }\n\n    handleChange(): void {\n        try {\n            const day = parseInt(this.inputDay.current.value);\n            if (isNaN(day)) throw \"day is not a number!\";\n            const month = parseInt(this.inputMonth.current.value);\n            if (isNaN(month)) throw \"month is not a number!\";\n            const year = parseInt(this.inputYear.current.value);\n            if (isNaN(year)) throw \"year is not a number!\";\n\n            const date = new Date(year, month, day);\n            if (date.getFullYear() !== year || date.getMonth() !== month || date.getDate() !== day) {\n                throw \"Invalid date!\";\n            }\n            this.setState({ error: \"\" });\n\n            const handler = this.props.onChange;\n            if (typeof handler !== 'function') return;\n            handler(date.getTime());\n        }\n        catch (ex) {\n            this.setState({ error: _(\"invalid\") });\n        }\n    }\n\n    render() {\n        const\n            p = this.props,\n            label = castString(p.label, \"\"),\n            value = castInteger(p.value, 0),\n            wide = castBoolean(p.wide, false),\n            error = castString(this.state.error, \"\"),\n            date = new Date(value),\n            id = nextId();\n        const classes = [\"tfw-view-input-date\", \"thm-ele-button\"];\n        if (wide) classes.push(\"wide\");\n        const header = (error.length > 0 ? <div className=\"thm-bgSD error\">{error}</div> :\n            (label ? (<label htmlFor={id} className=\"thm-bgPD\">{label}</label>) : null));\n        return (<div className={classes.join(\" \")} >\n            {header}\n            <div className=\"inputs\">\n                <input\n                    ref={this.inputDay}\n                    className=\"day\"\n                    type=\"number\"\n                    maxLength=\"2\"\n                    min=\"1\"\n                    max=\"31\"\n                    id={id}\n                    size=\"2\"\n                    onChange={this.handleChange}\n                    defaultValue={date.getDate()} />\n                <select ref={this.inputMonth}\n                    onChange={this.handleChange}\n                    defaultValue={date.getMonth()}>{\n                        [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11].map(monthId => (\n                            <option key={monthId} value={monthId}>{_(`month-${monthId}`)}</option>\n                        ))\n                    }</select>\n                <input\n                    ref={this.inputYear}\n                    className=\"year\"\n                    type=\"number\"\n                    maxLength=\"4\"\n                    size=\"4\"\n                    onChange={this.handleChange}\n                    defaultValue={date.getFullYear()} />\n            </div>\n        </div>);\n    }\n}\n\n\nlet globalId = 0;\nfunction nextId() {\n    return `tfw-view-input-${globalId++}`;\n}\n\n\nconst NUMBER_VALIDATOR = (value: string) => isNaN(parseFloat(value)) ? _('nan') : true;\n","import React from \"react\"\nimport { IFormField, ITypes, IType } from '../types'\nimport Combo from '../tfw/view/combo'\nimport Expand from '../tfw/view/expand'\nimport Checkbox from '../tfw/view/checkbox'\nimport InputDate from '../tfw/view/input-date'\nimport Storage from '../tfw/storage'\n\nimport \"./form-field.css\"\n\ninterface IFormFieldProps {\n    field: IFormField,\n    types: ITypes\n}\n\ninterface IFormFieldState {\n    values: { [key: string]: any }\n}\n\nexport default class FormField extends React.Component<IFormFieldProps, IFormFieldState> {\n    constructor( props: IFormFieldProps ) {\n        super( props );\n        this.state = { values: Storage.local.get(\"web-soins/form-field/values\", {}) }\n    }\n\n    setValue = (key: string, val: any) => {\n        const values = {\n            ...this.state.values,\n            [key]: val\n        }\n\n        Storage.local.set(\"web-soins/form-field/values\", values)\n        this.setState({ values }, () => {\n            console.info(\"key, val, values=\", key, val, values);\n        })\n    }\n\n    render() {\n        return (<div className=\"FormField\">{\n            this.renderField(this.props.field)\n        }</div>)\n    }\n\n    renderField = (field: IFormField): React.ReactNode => {\n        const { id, caption, children } = field\n        if (id.charAt(0) === '#') {\n            return this.renderTypedField(field, this.props.types)\n        }\n        return <Expand  key={id}\n                        label={caption}\n                        value={this.state.values[id]}\n                        onValueChange={(value: boolean) => this.setValue(id, value)}>\n                    <div>{\n                        Object.values(children).map(this.renderField)\n                    }</div>\n                </Expand>\n    }\n\n    renderTypedField(field: IFormField, types: ITypes): React.ReactNode {\n        const { id, caption, tags } = field\n        const typeId = field.type || '?'\n        const type = types[typeId]\n\n        if (!type) {\n            if (Array.isArray(tags)) {\n                if (tags.indexOf(\"@BOOL\")) {\n                    return <Checkbox key={id}\n                                label={`${caption} (${id})`}\n                                value={this.state.values[id]}\n                                onChange={(v: boolean) => this.setValue(id, v)}/>\n                }\n                if (tags.indexOf(\"@DATE\")) {\n                    return <InputDate key={id}\n                                label={`${caption} (${id})`}\n                                value={this.state.values[id]}\n                                onChange={(v: number) => this.setValue(id, v)}/>\n                }\n            }\n            return <pre key={id} className=\"error\">{\n                JSON.stringify(field, null, '  ')\n                + \"\\nTAGS: \" + JSON.stringify(tags)\n            }</pre>\n        }\n\n        return <Combo key={id}\n                    label={`${caption} (${id})`}\n                    value={this.state.values[id]}\n                    onChange={(v: string) => this.setValue(id, v)}>{\n            Object.values(type.children).map((t: IType) => (\n                <div key={t.id}>{t.caption} <em>({t.id})</em></div>\n            ))\n        }</Combo>\n    }\n}\n","import Intl from \"./tfw/intl\";\nexport default Intl.make(require(\"./App.yaml\"));\n","import React from \"react\"\n\nimport { IFilter } from \"../../types\"\nimport Button from \"../../tfw/view/button\"\nimport Flex from \"../../tfw/layout/flex\"\nimport InputDate from \"../../tfw/view/input-date\"\nimport PermissiveJSON from '../../tfw/permissive-json'\nimport Storage from \"../../tfw/storage\"\n\nimport \"./consultation-query.css\"\n\nimport _ from \"../../intl\"\n\ninterface TContainerQueryProps {\n    onQueryClick: (filter: IFilter, dateMin: number, dateMax: number) => void\n}\n\ninterface TContainerQueryState {\n    query: string,\n    valid: boolean,\n    dateMin: number,\n    dateMax: number\n}\n\nexport default class ContainerQuery extends React.Component<TContainerQueryProps, TContainerQueryState> {\n    constructor( props: TContainerQueryProps ) {\n        super(props)\n        this.state = {\n            dateMin: Storage.local.get('web-soins/container-query/dateMin', oneYearBack()),\n            dateMax: Storage.local.get('web-soins/container-query/dateMax', Date.now()),\n            valid: true,\n            query: Storage.local.get('web-soins/container-query/query', `[\n    OR\n    [= #VIH #POSITIVE]\n    [= #DIAGNOSIS-VIH #POSITIVE]\n]`)\n        }\n    }\n\n    private handleQueryChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        const target = evt.target\n        if (!target) return\n        const query = target.value as string\n        const valid = PermissiveJSON.isValid(query)\n        this.setState({ query, valid })\n    }\n\n    private handleExecuteClick = () => {\n        const { query, valid, dateMin, dateMax } = this.state\n        if (valid) {\n            Storage.local.set('web-soins/container-query/query', query)\n            const { onQueryClick } = this.props\n            onQueryClick(PermissiveJSON.parse(query), dateMin, dateMax)\n        }\n    }\n\n    private handleDateMinChange = (dateMin: number) => {\n        this.setState({ dateMin })\n    }\n\n    private handleDateMaxChange = (dateMax: number) => {\n        this.setState({ dateMax })\n    }\n\n    render() {\n        const { query, valid, dateMin, dateMax } = this.state\n        const classes = ['presentational-ConsultationQuery']\n\n        return (<div className={classes.join(' ')}>\n            <Flex>\n                <div><InputDate\n                    label={_(\"date-min\")}\n                    onChange={this.handleDateMinChange}\n                    value={dateMin} /></div>\n                <div><InputDate\n                    label={_(\"date-max\")}\n                    onChange={this.handleDateMaxChange}\n                    value={dateMax} /></div>\n            </Flex>\n            <label>{_('filter')}</label><br/>\n            <textarea className={valid ? 'valid' : 'invalid'}\n                      rows={15}\n                      onChange={this.handleQueryChange}>{\n                query\n            }</textarea><br/>\n            <Button icon=\"play\" label={_('execute-query')} enabled={valid} onClick={this.handleExecuteClick}/>\n        </div>)\n    }\n}\n\n/**\n * Return a date that is between one and two years old.\n * Then fix the month to January and the day to 1st.\n */\nfunction oneYearBack() {\n    const now = new Date()\n    const date = new Date(\n        now.getFullYear() - 1,\n        0,  // January\n        1\n    )\n    return date.valueOf()\n}\n","import WebService from \"../tfw/web-service\"\nimport { IFilter } from \"../types\"\n\n\nexport default { getConsultationIds, getConsultationsFields }\n\ninterface IConsultationIdsInput {\n    filter: IFilter,\n    minDate: number,\n    maxDate: number\n}\n\nasync function getConsultationIds(args: IConsultationIdsInput) {\n    const ids = await WebService.exec(\"query.consultation\", args)\n    return ids\n}\n\ninterface IConsultationsFieldsOutput {\n  fields: string[],\n  patients: {\n    [key: string /* Patient's key */]: Array<[number, ...string[]]>\n  }\n}\n\nasync function getConsultationsFields(consultationIds: number[]): Promise<IConsultationsFieldsOutput> {\n  const output = await WebService.exec(\"consultation.list\", consultationIds)\n  return output\n}\n","import React from \"react\"\nimport SaveAs from 'save-as'\nimport InputFile from '../tfw/view/input-file'\nimport State from '../state'\nimport { IFilter } from '../types'\nimport FormFieldView from '../presentational/form-field'\nimport ConsultationQuery from '../presentational/consultation-query'\nimport { IStructure, IFormField, ITypes } from '../types'\nimport QueryService from '../service/query'\nimport Dialog from '../tfw/factory/dialog'\nimport _ from \"../intl\";\n\nimport \"./report-view.css\"\n\ninterface IReportViewProps {\n    carecenter: number,\n    onFilesChange: (files: FileList) => void\n}\n\ninterface IReportViewState {\n    forms: { [key: string]: IFormField },\n    types: ITypes\n}\n\nexport default class ReportView extends React.Component<IReportViewProps, IReportViewState> {\n    constructor( props: IReportViewProps ) {\n        super( props );\n        this.state = { forms: {}, types: {} }\n    }\n\n    componentDidMount() {\n        const { carecenter } = this.props\n        const state = State.store.getState()\n        const structure = state.structures.find((s: IStructure) => s.id === carecenter);\n        if (!structure) return\n        this.setState({\n            forms: structure.forms,\n            types: structure.types\n        })\n    }\n\n    handleFilesChange = (files: FileList) => {\n        this.props.onFilesChange(files)\n    }\n\n    private async queryConsultations(filter: IFilter, minDate: number, maxDate: number) {\n      const ids = await QueryService.getConsultationIds({\n        filter, minDate, maxDate\n      })\n      const result = await QueryService.getConsultationsFields(ids)\n      const header = `\"Patient\",\"Consultation Date \",${result.fields.map(f => `\"${f}\"`).join(',')}`\n      const body = Object.keys(result.patients).map(\n        patientKey => result.patients[patientKey].map(\n          tail => removeSquareBrakets(JSON.stringify([patientKey, convertToDate(tail[0]), ...tail.slice(1)]))\n        ).join(\"\\n\")\n      ).join(\"\\n\")\n      return `${header}\\n${body}`\n    }\n\n    private handleQueryClick = async (filter: IFilter, minDate: number, maxDate: number) => {\n        console.info(\"filter=\", filter);\n        console.info(\"minDate=\", minDate);\n        console.info(\"maxDate=\", maxDate);\n        const csvContent = await Dialog.wait(\n          _('query-in-progress'),\n          this.queryConsultations(filter, minDate, maxDate)\n        )\n        const file = new Blob(\n          [csvContent],\n          { type: 'text/csv;charset=utf-8' }\n        )\n        SaveAs(file, `consultations.${\n          convertToDate(minDate / 1000)\n        }.${\n          convertToDate(maxDate / 1000)\n        }.csv`)\n    }\n\n    render() {\n        const { forms, types } = this.state\n\n        return (<div className=\"report-ReportView\">\n            <div>\n                <InputFile\n                    wide={true}\n                    icon=\"table\"\n                    label=\"Load report template from disk (*.fods)\"\n                    accept=\"fods\"\n                    multiple={true}\n                    onClick={this.handleFilesChange}/>\n                <p dangerouslySetInnerHTML={{\n                    __html: _('hint-report-templates')\n                }}></p>\n                <ul>\n                    <li><code>{'{{newPatients [Y,1,1] [Y,4,1]}}'}</code>: </li>\n                    <li><code>{'{{newPatients [Y,1,1] [Y,4,1] filter:[GENDER #F]}}'}</code>: </li>\n                    <li><code>{'{{newPatients [Y,1,1] [Y,4,1] filter:[age 18 40]}}'}</code>: </li>\n                    <li><code>{'{{visits [Y,1,1] [Y,4,1]}}</code>'}</code>: </li>\n                    <li><code>{'{{visits [Y,1,1] [Y,4,1] filter:{MOTIF-CONSULTATION: #GENITAL-LEAK}}}'}</code>: </li>\n                    <li><code>{'{{visits [Y,1,1] [Y,4,1] group:day}}'}</code>: </li>\n                </ul>\n                <hr/>\n                <ConsultationQuery onQueryClick={this.handleQueryClick} />\n            </div>\n            <div>{\n                Object.values(forms).map((field: IFormField) => (\n                    <FormFieldView key={field.id} types={types} field={field}/>\n                ))\n            }</div>\n        </div>)\n    }\n}\n\n\nfunction removeSquareBrakets(text: string): string {\n  return text.substr(1, text.length - 2)\n}\n\n\nfunction convertToDate(secondsSinceEpoch: number): string {\n  const date = new Date(secondsSinceEpoch * 1000)\n  const yy = date.getFullYear()\n  let mm = `${date.getMonth() + 1}`\n  let dd = `${date.getDate()}`\n  while (mm.length < 2) mm = `0${mm}`\n  while (dd.length < 2) dd = `0${dd}`\n\n  return `${yy}-${mm}-${dd}`\n}\n","import React from \"react\"\n\nimport PermissiveJSON from '../tfw/permissive-json'\nimport FileAPI from '../tfw/fileapi'\nimport Icon from '../tfw/view/icon'\nimport Button from '../tfw/view/button'\nimport Dialog from '../tfw/factory/dialog'\nimport Util from '../tfw/util'\nimport ReportView from './report-view'\nimport WS from '../tfw/web-service'\nimport _ from \"../intl\";\n\nimport LibreOfficeCalcTemplate from './report.fods'\n\nimport \"./report.css\"\n\nexport default { generate }\n\n\nasync function generate(extraData: {}) {\n    Dialog.alert(<div className=\"report-icons-container\">\n        <div>\n            <Icon content=\"report\" size={96} onClick={() => generateFromTemplate(extraData)}/>\n            <div>Rapport annuel</div>\n        </div>\n        <div>\n            <Icon content=\"file\" size={96} onClick={() => generateFromUserProvidedFile(extraData)}/>\n            <div><i>Générique...</i></div>\n        </div>\n    </div>)\n}\n\nasync function generateFromTemplate(extraData: {}) {\n    const content = await Dialog.wait(\n        _('loading-report'),\n        Util.loadTextFromURL(LibreOfficeCalcTemplate)\n    )\n    Dialog.wait(_(\"generating-report\"), doGenerate(content, extraData))\n}\n\nfunction generateFromUserProvidedFile(extraData: {}) {\n    const onFilesChange = async (files: FileList) => {\n        for(const file of files) {\n            const content = await Util.loadTextFromFile(file)\n            Dialog.wait(_(\"generating-report\"), doGenerate(content, extraData))\n        }\n        dialog.hide()\n    }\n\n    const dialog = Dialog.show({\n        content: <ReportView\n                    carecenter={extraData.carecenter}\n                    onFilesChange={onFilesChange}/>,\n        footer: <Button label=\"Close\" icon=\"cancel\" onClick={() => dialog.hide()}/>\n    })\n}\n\n\nasync function doGenerate(content: string, extraData: {}) {\n    //const content = await Util.loadTextFromURL(LibreOfficeCalcTemplate)\n    const domParser = new DOMParser();\n    const doc = domParser.parseFromString(content, \"application/xml\");\n    const placeholders: HTMLElement[] = []\n    findPlaceholders(doc.documentElement, placeholders)\n\n    const query = placeholders\n        .map((elem: HTMLElement) => {\n            const content = (elem.textContent || '{}').trim().substr(1)\n            try {\n                return {\n                    ...PermissiveJSON.parse(content.substr(0, content.length - 1)),\n                    ...extraData\n                }\n            }\n            catch (ex) {\n                console.error(ex)\n                console.info(\"elem=\", elem);\n                return { [0]: 'echo', [1]: content }\n            }\n        })\n    console.info(\"query=\", query);\n    const data = await WS.exec(\"report\", query)\n    console.info(\"data=\", data);\n\n    data.forEach((text: string, index: number) => {\n        const elem = placeholders[index]\n        const value = parseFloat(text)\n        elem.textContent = text\n        if (!Number.isNaN(value)) {\n            // We must tell Calc that this content is a number.\n            const parent = elem.parentElement\n            if (!parent) return\n            parent.setAttribute(\"office:value-type\", \"float\")\n            parent.setAttribute(\"calcext:value-type\", \"float\")\n            parent.setAttribute(\"office:value\", text)\n        }\n    })\n\n    const serializer = new XMLSerializer();\n    const xml = serializer.serializeToString(doc);\n\n    await FileAPI.saveAs(new Blob([xml]), \"report.ods\")\n}\n\n\nfunction findPlaceholders(element: HTMLElement, placeholders: HTMLElement[]) {\n    switch (element.nodeType) {\n        case Node.ELEMENT_NODE:\n            if (element.nodeName === 'text:p') {\n                const content = (element.textContent || '').trim()\n                if (content.startsWith('{{') && content.endsWith('}}')) {\n                    placeholders.push(element)\n                }\n            } else {\n                for (const child of element.childNodes) {\n                    findPlaceholders(child, placeholders)\n                }\n            }\n    }\n}\n","import * as React from \"react\"\nimport { ICarecenter, IStructure } from \"../types\"\nimport Button from \"../tfw/view/button\"\nimport Report from '../report'\nimport _ from \"../intl\";\n\nimport \"./carecenter-header.css\"\n\n\ninterface ICarecenterHeaderProps {\n    carecenter: ICarecenter;\n    structures: IStructure[];\n    onStatClick: (carecenter: ICarecenter) => void;\n    onStructClick: (carecenter: ICarecenter) => void;\n}\n\nexport default class CarecenterHeader extends React.Component<ICarecenterHeaderProps, {}> {\n    constructor(props: ICarecenterHeaderProps) {\n        super(props);\n        this.handleStatClick = this.handleStatClick.bind(this);\n    }\n\n    handleStatClick = () => {\n        const handler = this.props.onStatClick;\n        if (typeof handler !== 'function') return;\n        handler(this.props.carecenter);\n    }\n\n    handleStructClick = () => {\n        const handler = this.props.onStructClick;\n        if (typeof handler !== 'function') return;\n        handler(this.props.carecenter);\n    }\n\n    handleReportClick = () => {\n        const { carecenter } = this.props\n        Report.generate({ carecenter: carecenter.id })\n    }\n\n    render() {\n        const carecenter: ICarecenter = this.props.carecenter;\n        const structure: IStructure | undefined = this.props.structures.find(s => s.id === carecenter.structureId);\n\n        return (<div className=\"presentational-carecenter-header\">\n            <div>\n                <div className=\"name\">{carecenter.name}</div>\n                <div className=\"prop\">\n                    <div>{_(\"code\")}</div>\n                    <div>{carecenter.id}-{carecenter.code}</div>\n                </div>\n                <div className=\"prop\">\n                    <div>{_(\"patients-count\")}</div>\n                    <div>{carecenter.patientsCount}</div>\n                </div>\n                <div className=\"prop\">\n                    <div>{_(\"consultations-count\")}</div>\n                    <div>{carecenter.consultationsCount}</div>\n                </div>\n                <div className=\"prop\">\n                    <div>{_(\"struct\")}</div>\n                    <div>{structure ? structure.name : '...'}</div>\n                </div>\n            </div>\n            <div className=\"buttons\">\n                <Button icon=\"stat\" small={true} onClick={this.handleStatClick} /><br />\n                <Button icon=\"report\" small={true} onClick={this.handleReportClick} /><br />\n            </div>\n        </div>);\n    }\n}\n","import React from \"react\"\r\nimport castArray from \"../tfw/converter/array\"\r\nimport castString from \"../tfw/converter/string\"\r\nimport castInteger from \"../tfw/converter/integer\"\r\nimport Flex from \"../tfw/layout/flex\"\r\nimport Combo from \"../tfw/view/combo\"\r\nimport InputDate from \"../tfw/view/input-date\"\r\nimport StatsPatientsConfig from \"../container/stats-patients-config\"\r\nimport { IStatsConfig } from \"../types\"\r\nimport _ from \"../intl\"\r\n\r\ninterface IStatsConfigProps extends IStatsConfig {\r\n    onTypeChange?: (type: string) => void;\r\n    onDateMinChange?: (date: number) => void;\r\n    onDateMaxChange?: (date: number) => void;\r\n}\r\n\r\nexport default class StatsConfig extends React.Component<IStatsConfigProps, {}> {\r\n    constructor(props: IStatsConfigProps) {\r\n        super(props);\r\n        this.handleTypeChange = this.handleTypeChange.bind(this);\r\n        this.handleDateMinChange = this.handleDateMinChange.bind(this);\r\n        this.handleDateMaxChange = this.handleDateMaxChange.bind(this);\r\n    }\r\n\r\n    handleTypeChange(index: number) {\r\n        const handler = this.props.onTypeChange;\r\n        if (typeof handler !== 'function') return;\r\n        handler(index === 0 ? 'patients' : 'consultations');\r\n    }\r\n\r\n    handleDateMinChange(date: number) {\r\n        const handler = this.props.onDateMinChange;\r\n        if (typeof handler !== 'function') return;\r\n        try {\r\n            handler(date);\r\n        } catch (ex) {\r\n            console.error(\"Error in handleDateMinChange(date): \", date);\r\n            console.error(ex);\r\n        }\r\n    }\r\n\r\n    handleDateMaxChange(date: number) {\r\n        const handler = this.props.onDateMaxChange;\r\n        if (typeof handler !== 'function') return;\r\n        try {\r\n            handler(date);\r\n        } catch (ex) {\r\n            console.error(\"Error in handleDateMaxChange(date): \", date);\r\n            console.error(ex);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const p = this.props;\r\n        const type = castString(p.statsType, \"consultations\");\r\n        const dateMin = castInteger(p.dateMin, Date.now());\r\n        const dateMax = castInteger(p.dateMax, Date.now());\r\n        const types = [\"consultations\", \"patients\"];\r\n\r\n        return (<div>\r\n            <Combo\r\n                wide={true}\r\n                label={_(\"stat-type\")}\r\n                keys={types}\r\n                value={type}\r\n            >{\r\n                    types.map(type => (\r\n                        <div key={type}>{_(type)}</div>\r\n                    ))\r\n                }</Combo>\r\n            <Flex>\r\n                <div><InputDate\r\n                    label={_(\"date-min\")}\r\n                    onChange={this.handleDateMinChange}\r\n                    value={dateMin} /></div>\r\n                <div><InputDate\r\n                    label={_(\"date-max\")}\r\n                    onChange={this.handleDateMaxChange}\r\n                    value={dateMax} /></div>\r\n            </Flex>\r\n        </div>);\r\n        /*\r\n        return (\r\n            <Tabstrip\r\n                value={value}\r\n                headers={[_(\"patients\"), _(\"consultations\")]}\r\n                onChange={this.handleTypeChange}\r\n            >\r\n                <StatsPatientsConfig\r\n                    dateMin={dateMin}\r\n                    dateMax={dateMax} />\r\n                <div>Not implemented yet!</div>\r\n            </Tabstrip>\r\n        )*/\r\n    }\r\n}\r\n","import { connect } from 'react-redux'\nimport StatsConfig from \"../presentational/stats-config\"\nimport Actions from \"../state/stats-config\"\nimport { IState, IDispatchFunction } from \"../types\"\n\nfunction mapStateToProps(state: IState) {\n    return {\n        statsType: state.statsConfig.statsType,\n        dateMin: state.statsConfig.dateMin,\n        dateMax: state.statsConfig.dateMax\n    }\n}\n\nfunction mapDispatchToProps(dispatch: IDispatchFunction) {\n    return {\n        onTypeChange(type: \"patients\" | \"consultations\") {\n            dispatch(Actions.setType(type));\n        },\n\n        onDateMinChange(date: number) {\n            console.info(\"[onDateMinChange] date=\", date);\n            dispatch(Actions.setDateMin(date));\n        },\n\n        onDateMaxChange(date: number) {\n            dispatch(Actions.setDateMax(date));\n        }\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(StatsConfig);\n","import * as React from \"react\"\r\nimport { Provider } from 'react-redux'\r\nimport State from \"../state\"\r\nimport StatsConfig from \"../container/stats-config\"\r\nimport Dialog from \"../tfw/factory/dialog\"\r\nimport Button from \"../tfw/view/button\"\r\n\r\nimport _ from \"../intl\"\r\n\r\nexport default {\r\n    show() {\r\n        const dialog = Dialog.show({\r\n            closeOnEscape: true,\r\n            icon: \"stat\",\r\n            title: _(\"create-stat\"),\r\n            content: (<Provider store={State.store}><StatsConfig /></Provider>),\r\n            footer: [\r\n                <Button\r\n                    key=\"cancel\"\r\n                    label={_(\"cancel\")}\r\n                    flat={true}\r\n                    onClick={() => dialog.hide()} />,\r\n                <Button\r\n                    key=\"ok\"\r\n                    label={_(\"create-stat\")}\r\n                    warning={true}\r\n                    onClick={() => {\r\n                        dialog.hide();\r\n                        State.dispatch(State.addStat());\r\n                    }} />\r\n            ]\r\n        });\r\n\r\n    }\r\n}\r\n","import { connect } from 'react-redux'\nimport CarecenterHeader from \"../presentational/carecenter-header\"\nimport { IState, ICarecenter, IDispatchFunction } from \"../types\"\nimport State from \"../state\"\nimport StatsConfigDialog from \"../dialog/stats-config\"\n\nfunction mapStateToProps(state: IState) {\n    return {}\n}\n\nfunction mapDispatchToProps(dispatch: IDispatchFunction) {\n    return {\n        onStatClick(carecenter: ICarecenter) {\n            console.log(\"carecenter=\", carecenter);\n            dispatch(State.initStatsConfig(carecenter.id));\n            StatsConfigDialog.show();\n        },\n\n        onStructClick(carecenter: ICarecenter) {\n            console.log(\"carecenter=\", carecenter);\n        }\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CarecenterHeader);\n","import React from \"react\"\nimport Icon from '../../tfw/view/icon'\nimport _ from '../../intl'\n\nimport \"./wait.css\"\n\ninterface IWaitProps {\n    label?: string\n}\n\nexport default class Wait extends React.Component<IWaitProps, {}> {\n    render() {\n        return (<div className=\"webSoins-Wait\">\n            <Icon content=\"wait\" animate={true} />\n            <div>{this.props.label || _(\"loading\")}</div>\n        </div>)\n    }\n}\n","import * as React from \"react\"\r\nimport castArray from \"../tfw/converter/array\"\r\nimport castInteger from \"../tfw/converter/integer\"\r\nimport \"./pie.css\"\r\n\r\ninterface IPieProps {\r\n    values: number[];\r\n    colors?: string[];\r\n    size?: number;\r\n}\r\ninterface IPieState { }\r\n\r\nconst DEFAULT_COLORS = [\"#b37036\", \"#cc7529\", \"#e67717\", \"#ff7700\", \"#765\"];\r\n\r\nexport default class Pie extends React.Component<IPieProps, IPieState> {\r\n    private readonly canvas: React.RefObject<HTMLCanvasElement> = React.createRef();\r\n\r\n    componentDidMount() {\r\n        this.paint();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.paint();\r\n    }\r\n\r\n    paint() {\r\n        if (!this.canvas.current) return;\r\n        const\r\n            canvas: HTMLCanvasElement = this.canvas.current,\r\n            values = this.props.values,\r\n            colors = castArray(this.props.colors, DEFAULT_COLORS).slice(),\r\n            size = canvas.width,\r\n            lineWidth = 1,\r\n            radius = Math.floor(size / 2) - 3,\r\n            turn = 2 * Math.PI,\r\n            angleStep = turn / size,\r\n            total = this.props.values.reduce((acc, val) => val + acc),\r\n            ctx = canvas.getContext(\"2d\");\r\n        if (!ctx) return;\r\n        let\r\n            angle = 0,\r\n            angleTarget = 0;\r\n\r\n        const lineTo = (ang: number) => ctx.lineTo(radius * Math.sin(ang), -radius * Math.cos(ang));\r\n\r\n        ctx.save();\r\n        ctx.clearRect(0, 0, size, size);\r\n        if (total > 0) {\r\n            ctx.translate(size / 2, size / 2);\r\n            ctx.fillStyle = \"#000\";\r\n            ctx.globalAlpha = 0.5;\r\n            ctx.ellipse(0, 0, size / 2, size / 2, 0, 0, Math.PI * 2);\r\n            ctx.fill();\r\n            ctx.strokeStyle = \"#000\";\r\n            ctx.lineWidth = lineWidth;\r\n            for (let i = 0; i < colors.length; i++) {\r\n                const color = colors[i % colors.length];\r\n                ctx.fillStyle = color;\r\n                ctx.beginPath();\r\n                ctx.moveTo(0, 0);\r\n                angleTarget = angle + turn * values[i] / total;\r\n                do {\r\n                    lineTo(angle);\r\n                    angle += angleStep;\r\n                } while (angle < angleTarget)\r\n                lineTo(angleTarget);\r\n                angle = angleTarget;\r\n                ctx.closePath();\r\n                ctx.globalAlpha = 1;\r\n                ctx.fill();\r\n                ctx.globalAlpha = 0.2;\r\n                ctx.stroke();\r\n            }\r\n        }\r\n        ctx.restore();\r\n    }\r\n\r\n    render() {\r\n        const p = this.props;\r\n        const colors = castArray(p.colors, DEFAULT_COLORS);\r\n        const size = castInteger(p.size, 200);\r\n\r\n        return (\r\n            <canvas\r\n                ref={this.canvas}\r\n                width={size} height={size}\r\n                className=\"presentation-pie\">\r\n            </canvas>\r\n        );\r\n    }\r\n}\r\n","import WebService from \"../tfw/web-service\"\r\nimport { IStatsConfig, IOccurences, IOccurence } from \"../types\"\r\n\r\ninterface IServiceExtract {\r\n    patients: {};\r\n    data: {};\r\n}\r\n\r\ninterface IOccurencesDictionary {\r\n    [key: string]: { [key: string]: number }\r\n}\r\n\r\nexport default {\r\n    async extract(statsConfig: IStatsConfig): Promise<{}> {\r\n        const extraction = await WebService.exec(\"extract\", {\r\n            carecenter: statsConfig.carecenter.id,\r\n            begin: convertTime(statsConfig.dateMin),\r\n            end: convertTime(statsConfig.dateMax)\r\n        });\r\n        const result = {};\r\n        Object.values(extraction.data).forEach(consultation => {\r\n            Object.keys(consultation)\r\n                .filter(key => key.charAt(0) === '#')\r\n                .forEach(key => {\r\n                    const val = consultation[key];\r\n                    if (typeof result[key] === 'undefined') {\r\n                        result[key] = {};\r\n                    }\r\n                    const item = result[key];\r\n                    const occurences = item[val];\r\n                    if (typeof occurences === 'undefined') {\r\n                        item[val] = 1;\r\n                    } else {\r\n                        item[val]++;\r\n                    }\r\n                })\r\n        })\r\n        return convertIntoOccurences(result);\r\n    }\r\n}\r\n\r\n/**\r\n * Convert a number of milliseconds into a number of seconds.\r\n */\r\nfunction convertTime(milliseconds: number): number {\r\n    return Math.floor(.5 + milliseconds * 0.001);\r\n}\r\n\r\n\r\nfunction convertIntoOccurences(input: IOccurencesDictionary): { [key: string]: IOccurences } {\r\n    const result: { [key: string]: IOccurences } = {};\r\n    Object.keys(input).forEach(fieldName => {\r\n        const occurences = { sum: 0, occ: [] };\r\n        result[fieldName] = occurences;\r\n        const fieldValues = input[fieldName];\r\n        Object.keys(fieldValues).forEach(value => {\r\n            const occ = fieldValues[value];\r\n            occurences.sum += occ;\r\n            occurences.occ.push([value, occ]);\r\n        })\r\n        occurences.occ.sort(sortDescBySecondElement);\r\n    })\r\n    return result;\r\n}\r\n\r\n\r\nfunction sortDescBySecondElement(a: IOccurence, b: IOccurence): number {\r\n    const\r\n        A = a[1],\r\n        B = b[1];\r\n    return B - A;\r\n}\r\n","import * as React from \"react\"\r\nimport { IStatsConfig, IStructure, IOccurences } from \"../types\"\r\nimport Pie from \"./pie\"\r\nimport Flex from \"../tfw/layout/flex\"\r\nimport Icon from \"../tfw/view/icon\"\r\nimport Combo from \"../tfw/view/combo\"\r\nimport Button from \"../tfw/view/button\"\r\nimport FileAPI from \"../tfw/fileapi\"\r\nimport Structure from \"../structure\"\r\nimport StatService from \"../service/stat\"\r\n\r\nimport Intl from \"../tfw/intl\"\r\nconst _ = Intl.make(require(\"./stat.yaml\"));\r\n\r\nimport \"./stat.css\"\r\n\r\nconst DEFAULT_COLORS = [\"#b37036\", \"#cc7529\", \"#e67717\", \"#ff7700\", \"#765\"];\r\n\r\ntype TDataFromService = { [key: string]: IOccurences };\r\n\r\ninterface IStatProps {\r\n    stat: IStatsConfig;\r\n    structure: IStructure;\r\n    onClose?: () => void;\r\n}\r\n\r\ninterface IStatState {\r\n    dataFromService?: TDataFromService;\r\n    selectedField: string;\r\n}\r\n\r\nexport default class Stat extends React.Component<IStatProps, IStatState> {\r\n    constructor(props: IStatProps) {\r\n        super(props);\r\n        this.state = { selectedField: \"\" };\r\n        this.handleClose = this.handleClose.bind(this);\r\n    }\r\n\r\n    handleClose() {\r\n        const handler = this.props.onClose;\r\n        if (typeof handler !== 'function') return;\r\n        try {\r\n            handler();\r\n        } catch (ex) {\r\n            console.error(\"Error in handleClose(): \", );\r\n            console.error(ex);\r\n        }\r\n    }\r\n    componentDidUpdate() {\r\n        if (this.state.dataFromService) return;\r\n        console.log(\"componentDidUpdate\");\r\n        this.refresh();\r\n    }\r\n\r\n    componentDidMount() {\r\n        console.log(\"componentDidMount\");\r\n        this.refresh();\r\n    }\r\n\r\n    async refresh() {\r\n        const dataFromService = await StatService.extract(this.props.stat);\r\n        console.info(\"data=\", dataFromService);\r\n        this.setState({ dataFromService });\r\n    }\r\n\r\n    private export() {\r\n        const data: TDataFromService | undefined = this.state.dataFromService;\r\n        if (!data) return;\r\n        const { keys, values } = getFieldsKeysAndValues(data, this.props.structure);\r\n        const output: string[] = [\"Code du champ\\tNom du champ\\tValeur\\tOccurences\"];\r\n        keys.forEach((fieldKey: string, idx: number) => {\r\n            const fieldCaption = values[idx];\r\n            const occurences = data[fieldKey].occ;\r\n            occurences.forEach(([caption, count]: [string, number]) => {\r\n                output.push(`${fieldKey}\\t${fieldCaption}\\t${caption}\\t${count}`);\r\n            })\r\n        });\r\n\r\n        const filename = \"statistics.xls\";\r\n        FileAPI.saveAs(new Blob([output.join(\"\\n\")], { type: \"text/csv\" }), filename);\r\n    }\r\n\r\n    render() {\r\n        const data: TDataFromService | undefined = this.state.dataFromService;\r\n        let content = null;\r\n        if (!data) {\r\n            content = (<Flex>\r\n                <Icon content=\"wait\" animate={true} /><div>{\"Chargement en cours...\"}</div>\r\n            </Flex>);\r\n        } else {\r\n            const { keys, values } = getFieldsKeysAndValues(data, this.props.structure);\r\n            let value = this.state.selectedField;\r\n            if (keys.indexOf(value) === -1) value = keys[0];\r\n            const occurences = data[value];\r\n            if (!occurences) {\r\n                content = <div>{_(\"no-data\")}</div>;\r\n            } else {\r\n                content = (<div>\r\n                    <Combo\r\n                        keys={keys}\r\n                        onChange={selectedField => {\r\n                            console.info(\"[onChange] selectedField=\", selectedField);\r\n                            this.setState({ selectedField });\r\n                        }}\r\n                        value={value}>{\r\n                            values.map((val, idx) => {\r\n                                const key = keys[idx];\r\n                                return <div key={key}><b>{`${val} `}</b><small className='grey'>{key}</small></div>\r\n                            })\r\n                        }</Combo>\r\n                    <br />\r\n                    <center>\r\n                        <Pie colors={DEFAULT_COLORS}\r\n                            values={getValuesForPie(occurences)} />\r\n                    </center>\r\n                    <div>{\r\n                        occurences.occ.map(([caption, count], index) => {\r\n                            const colorIndex = Math.min(DEFAULT_COLORS.length - 1, index);\r\n                            const color = DEFAULT_COLORS[colorIndex];\r\n                            return (\r\n                                <Flex key={index}\r\n                                    justifyContent=\"space-between\"\r\n                                    alignItems=\"center\"\r\n                                    dir=\"row\"\r\n                                    classes={index % 2 ? \"thm-bg1\" : \"thm-bg2\"}>\r\n                                    <Flex\r\n                                        justifyContent=\"space-between\"\r\n                                        wide={false}\r\n                                        dir=\"row\"\r\n                                        alignItems=\"center\">\r\n                                        <div className=\"bullet\" style={{\r\n                                            background: color\r\n                                        }}></div>\r\n                                        <span>{caption}</span>\r\n                                    </Flex>\r\n                                    <div><b>{count}</b></div>\r\n                                </Flex>\r\n                            )\r\n                        })\r\n                    }</div>\r\n                    <Button\r\n                        wide={true}\r\n                        icon=\"export\"\r\n                        label={_(\"export\")}\r\n                        onClick={() => this.export()} />\r\n                </div >);\r\n            }\r\n        }\r\n\r\n        const stat: IStatsConfig = this.props.stat;\r\n        return (\r\n            <div className=\"presentational-stat thm-ele-card thm-bg1\">\r\n                <div className=\"thm-bgPD\">{`${stat.carecenter.name}, du ${formatDate(stat.dateMin)} au ${formatDate(stat.dateMax)}`}</div>\r\n                <div>{content}</div>\r\n                <hr />\r\n                <Flex dir=\"row\" justifyContent=\"flex-end\">\r\n                    <Button\r\n                        onClick={this.handleClose}\r\n                        icon=\"close\"\r\n                        label={_(\"close\")}\r\n                        flat={true} />\r\n                </Flex>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nfunction getFieldsKeysAndValues(data: TDataFromService, structure: IStructure): { keys: string[], values: string[] } {\r\n    const keys = Object.keys(data);\r\n    const values = keys.map(key => Structure.getFieldCaption(key, structure));\r\n    const array = keys.map((key, index) => [key, values[index]]);\r\n    array.sort((a, b) => {\r\n        const A = a[1];\r\n        const B = b[1];\r\n        if (A < B) return -1;\r\n        if (A > B) return +1;\r\n        return 0;\r\n    });\r\n\r\n    return {\r\n        keys: array.map(item => item[0]),\r\n        values: array.map(item => item[1])\r\n    };\r\n}\r\n\r\nfunction formatDate(date: number): string {\r\n    const d = new Date(date);\r\n    return `${d.getDate()}-${1 + d.getMonth()}-${d.getFullYear()}`;\r\n}\r\n\r\n\r\nfunction getValuesForPie(occurences: IOccurences, sectors: number = 4): number[] {\r\n    const { sum, occ } = occurences;\r\n    const values: number[] = [];\r\n    let total = 0;\r\n    for (let i = 0; i < Math.min(sectors, occ.length); i++) {\r\n        const [, count] = occ[i];\r\n        values.push(count);\r\n        total += count;\r\n    }\r\n    if (sum > total) values.push(sum - total);\r\n    return values;\r\n}\r\n","import React from \"react\"\nimport castArray from \"../converter/array\"\nimport castString from \"../converter/string\"\nimport castBoolean from \"../converter/boolean\"\nimport Button from \"../view/button\"\nimport Gesture from \"../gesture\"\nimport \"./sidemenu.css\"\n\ninterface ISidemenuProps {\n    show?: boolean;\n    head?: string;\n    menu?: React.ReactElement<HTMLDivElement>;\n    body?: React.ReactElement<HTMLDivElement>;\n    classes?: string[] | string;\n    onShowChange?: (isMenuVisible: boolean) => void;\n}\n\nexport default class Sidemenu extends React.Component<ISidemenuProps, {}> {\n    refMenu = React.createRef<HTMLDivElement>();\n\n    constructor(props: ISidemenuProps) {\n        super(props);\n        this.handleShowChange = this.handleShowChange.bind(this);\n    }\n\n    componentDidMount() {\n        const menu = this.refMenu.current;\n        if (!menu) return;\n        Gesture(menu).on({\n            swipeleft: () => {\n                const handler = this.props.onShowChange;\n                if (typeof handler === 'function') handler(false);\n            }\n        });\n    }\n    handleShowChange() {\n        const handler = this.props.onShowChange;\n        if (typeof handler !== 'function') return;\n        handler(!castBoolean(this.props.show, window.innerWidth > 480));\n    }\n\n    render() {\n        const show = castBoolean(this.props.show, window.innerWidth > 480);\n        const head = castString(this.props.head, \"\");\n        const classes = [\"tfw-layout-sidemenu thm-bg0\"].concat(castArray(this.props.classes));\n        if (show) classes.push(\"show\");\n\n        return (\n            <div className={classes.join(\" \")} >\n                <div className=\"body thm-bg0\" >{this.props.body}</div>\n                <div className=\"menu thm-ele-nav thm-bg1\" ref={this.refMenu}>\n                    <header className=\"thm-ele-nav thm-bgPD\" >{head}</header>\n                    <menu> {this.props.menu} </menu>\n                </div>\n                <div className=\"icon thm-bgPD\" >\n                    <Button icon=\"menu\" flat={true} onClick={this.handleShowChange} />\n                </div>\n            </div>\n        );\n    }\n}\n","import * as React from \"react\"\nimport { connect } from 'react-redux'\nimport CarecenterHeader from \"./carecenter-header\"\nimport Wait from \"../presentational/wait\"\nimport Stat from \"../presentational/stat\"\nimport Sidemenu from \"../tfw/layout/sidemenu\"\nimport Icon from \"../tfw/view/icon\"\nimport Flex from \"../tfw/layout/flex\"\nimport Button from \"../tfw/view/button\"\nimport User from \"../state/user\"\nimport State from \"../state\"\nimport Hash from \"../util/hash\"\n\nimport { IState, IDispatchFunction, IOrganization, ICarecenter } from \"../types\"\nimport _ from \"../intl\";\n\nimport \"./sidemenu.css\"\n\nfunction mapStateToProps(state: IState) {\n    const stats = state.stats.map(stat => {\n        const carecenter = stat.carecenter;\n        const structureId = carecenter.id;\n        const structure = state.structures.find(s => s.id === structureId);\n        if (!structure) {\n            console.error(`There is no Structure with id=${structureId} in carecenter \"${carecenter.name}\"!`);\n            return null;\n        }\n        const key = Hash.statsConfig(stat);\n        return (<Stat key={key}\n            stat={stat}\n            onClose={() => State.dispatch(State.removeStat(key))}\n            structure={structure} />);\n    });\n    return {\n        head: state.user.nickname,\n        menu: (<div>\n            <ul>{state.organizations.map((organization: IOrganization) => (\n                <li key={organization.id}>{organization.name}<ul>{\n                    renderCareCenterHeader(state, organization)\n                }</ul></li>\n            ))\n            }</ul>\n            <br /><hr /><br />\n            <Button label={_(\"logout\")} icon=\"logout\" wide={true}\n                onClick={() => window.location.reload()} />\n        </div>),\n        body: stats.length > 0 ? stats : (\n            <Flex\n                dir=\"column\"\n                alignItems=\"center\"\n                classes={[\"container-sidemenu\", \"welcome\"]}\n            >\n                <div>{_(\"welcome\")}</div>\n                <Icon content=\"stat\" />\n                <div>{_(\"report\")}</div>\n                <Icon content=\"report\" />\n            </Flex>\n        )\n    }\n}\n\nfunction renderCareCenterHeader(state: IState, organization: IOrganization) {\n    const carecentersOfOrganization = state.carecenters.filter((carecenter: ICarecenter) =>\n        carecenter.organizationId === organization.id)\n    if (carecentersOfOrganization.length === 0) return <Wait/>\n\n    return carecentersOfOrganization.map((carecenter: ICarecenter) => (\n        <CarecenterHeader\n            key={carecenter.id}\n            carecenter={carecenter}\n            structures={state.structures} />\n    ))\n}\n\nfunction mapDispatchToProps(dispatch: IDispatchFunction) {\n    return {\n        onLanguageClick() {\n            dispatch(User.setLanguage(\"jp\"));\n        },\n\n        onLogoutClick() {\n            window.location.reload();\n        }\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidemenu);\n","import * as React from \"react\"\n\nimport { IUser } from \"./types\"\nimport Sidemenu from \"./container/sidemenu\"\n\nimport \"./App.css\"\n\ninterface IAppProps {\n    user: IUser\n}\n\nexport default class App extends React.Component<IAppProps, {}> {\n    render() {\n        return <Sidemenu classes=\"App\" />\n    }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport State from \"./state\"\nimport Intl from \"./tfw/intl\";\nimport { IUser, IOrganization, ICarecenter, IStructure } from \"./types\"\nimport ServiceOrganization from \"./service/organization\"\nimport ServiceCarecenter from \"./service/carecenter\"\nimport ServiceStructure from \"./service/structure\"\n\nimport App from \"./App\";\n\nexport default {\n    async start(user: IUser) {\n        const root = document.getElementById(\"root\");\n        ReactDOM.render(\n            <Provider store={State.store}><App user={user} /></Provider>,\n            root);\n        State.dispatch(State.User.setLanguage(Intl.lang));\n        State.dispatch(State.User.setNickname(user.nickname));\n        const organizations = await ServiceOrganization.list();\n        State.dispatch(State.Organizations.setOrganizations(organizations));\n        State.dispatch(State.Carecenters.setCarecenters([]));\n        organizations.forEach(async (organization: IOrganization) => {\n            const structures = await ServiceStructure.list(organization.id);\n            structures.forEach((structure: IStructure) => {\n                State.dispatch(State.Structures.addStructure(structure));\n            });\n            const carecenters = await ServiceCarecenter.list(organization.id);\n            carecenters.forEach((carecenter: ICarecenter) => {\n                State.dispatch(State.Carecenters.addCarecenter(carecenter));\n            });\n        })\n    }\n}\n"],"sourceRoot":""}